import{a as qe,s as y,j as e}from"./index-DDk1oefv.js";import{r as b}from"./react-vendor-xiFAdxLt.js";import{f as V}from"./dateUtils-DoPl8O0G.js";import{v as Re,w as Xe,x as Be,y as Ge,U as He,z as ze,E as W,H as le,J as We,K as Oe,R as ne}from"./ui-vendor-B0ZOy8uN.js";import"./supabase-vendor-B-LuImWU.js";function et(){var ye,_e,je;const{t:g,i18n:ve}=qe(),f=ve.language==="ar",[X,Ne]=b.useState([]),[we,ke]=b.useState(!0),[M,Ce]=b.useState(""),[O,Ee]=b.useState("all"),[ie,U]=b.useState(null),[a,D]=b.useState(null),[Se,B]=b.useState(!1),[$e,Y]=b.useState(!1),[Pe,J]=b.useState(!1),[G,K]=b.useState("details"),[q,oe]=b.useState([]),[d,de]=b.useState(null),[m,Ae]=b.useState(null),[Fe,ce]=b.useState(!1),[me,Q]=b.useState(!1),[ue,L]=b.useState(!1),[Z,De]=b.useState(null),ee=b.useRef(null),[xe,pe]=b.useState(null),[te,se]=b.useState(null),[F,ae]=b.useState(!1),[s,x]=b.useState({national_id:"",first_name_en:"",last_name_en:"",email:"",phone:"",department:"",job_title:"",employment_status:"active",hire_date:"",portal_username:"",portal_password:"",portal_access_enabled:!1}),[l,S]=b.useState({first_name_en:"",last_name_en:"",email:"",phone:"",department:"",job_title:"",employment_status:"active",hire_date:"",portal_username:"",portal_password:"",portal_access_enabled:!1}),[_,A]=b.useState({iban:"",bank_name:"",bank_branch_code:"",account_holder_name_ar:"",investment_account_number:"",broker_custodian_name:"",broker_account_number:"",tadawul_investor_number:""});b.useEffect(()=>{R()},[]),b.useEffect(()=>{const t=r=>{ee.current&&!ee.current.contains(r.target)&&U(null)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const R=async()=>{try{const{data:{user:t}}=await y.auth.getUser();if(!t)return;const{data:r}=await y.from("company_users").select("company_id").eq("user_id",t.id).maybeSingle();if(r){const{data:n,error:c}=await y.from("employees").select("*").eq("company_id",r.company_id).order("created_at",{ascending:!1});if(c)throw c;if(n){const{data:h}=await y.from("grants").select("employee_id, total_shares, vested_shares, remaining_unvested_shares, status").eq("company_id",r.company_id).in("status",["active","pending_signature"]),i=(h||[]).reduce((u,j)=>{u[j.employee_id]||(u[j.employee_id]={total_shares:0,vested_shares:0,unvested_shares:0}),u[j.employee_id].total_shares+=Number(j.total_shares)||0,u[j.employee_id].vested_shares+=Number(j.vested_shares)||0;const o=(Number(j.total_shares)||0)-(Number(j.vested_shares)||0);return u[j.employee_id].unvested_shares+=o,u},{}),p=n.map(u=>{const j=i[u.id]||{total_shares:0,vested_shares:0,unvested_shares:0},o=j.total_shares>0?j.vested_shares/j.total_shares*100:0;return{...u,...j,vesting_progress:o}});Ne(p)}}}catch(t){console.error("Error loading employees:",t)}finally{ke(!1)}},H=X.filter(t=>{const r=t.first_name_en.toLowerCase().includes(M.toLowerCase())||t.last_name_en.toLowerCase().includes(M.toLowerCase())||t.email.toLowerCase().includes(M.toLowerCase())||t.employee_number.toLowerCase().includes(M.toLowerCase()),n=O==="all"||t.employment_status===O;return r&&n}),he=async t=>{D(t),B(!0),U(null),K("details"),await z(t.id)},z=async t=>{ce(!0);try{const{data:{user:r}}=await y.auth.getUser();if(!r)return;const{data:n}=await y.from("company_users").select("company_id").eq("user_id",r.id).maybeSingle();if(!n)return;const{data:c,error:h}=await y.from("grants").select(`
          *,
          incentive_plans:plan_id (
            plan_name_en,
            plan_type,
            exercise_price
          )
        `).eq("employee_id",t).order("grant_date",{ascending:!1});if(h)throw h;if(c){const u=c.filter(w=>w.status==="active"||w.status==="pending_signature"),j=await Promise.all(u.map(async w=>{const{data:N}=await y.from("vesting_events").select("*").eq("grant_id",w.id).order("sequence_number",{ascending:!0});let I=Number(w.vested_shares)||0;return N&&N.length>0&&(I=N.filter(v=>v.status==="vested"||v.status==="transferred"||v.status==="exercised").reduce((v,E)=>v+Number(E.shares_to_vest||0),0)),{...w,computed_vested_shares:I,total_transferred:(N==null?void 0:N.filter(v=>v.status==="transferred").reduce((v,E)=>v+Number(E.shares_to_vest||0),0))||0,total_exercised:(N==null?void 0:N.filter(v=>v.status==="exercised").reduce((v,E)=>v+Number(E.shares_to_vest||0),0))||0}}));oe(j);const o=u.reduce((w,N)=>w+(Number(N.total_shares)||0),0),k=j.reduce((w,N)=>w+(N.computed_vested_shares||0),0),T=o-k,$=u.reduce((w,N)=>{var E;const I=Number(N.total_shares)||0,v=Number((E=N.incentive_plans)==null?void 0:E.exercise_price)||0;return w+I*v},0),{data:C}=await y.from("companies").select("total_shares_authorized").eq("id",n.company_id).maybeSingle(),P=C!=null&&C.total_shares_authorized?o/Number(C.total_shares_authorized)*100:0;de({total_shares:o,vested_shares:k,unvested_shares:T,ownership_percentage:P,market_value:$})}const{data:i,error:p}=await y.from("employee_financial_info").select("*").eq("employee_id",t).maybeSingle();p?console.error("Error loading financial info:",p):(Ae(i),i&&A({iban:i.iban||"",bank_name:i.bank_name||"",bank_branch_code:i.bank_branch_code||"",account_holder_name_ar:i.account_holder_name_ar||"",investment_account_number:i.investment_account_number||"",broker_custodian_name:i.broker_custodian_name||"",broker_account_number:i.broker_account_number||"",tadawul_investor_number:i.tadawul_investor_number||""}))}catch(r){console.error("Error loading employee financials:",r)}finally{ce(!1)}},Te=t=>{D(t),x({national_id:t.national_id||"",first_name_en:t.first_name_en,last_name_en:t.last_name_en,email:t.email,phone:t.phone||"",department:t.department||"",job_title:t.job_title||"",employment_status:t.employment_status,hire_date:t.hire_date||"",portal_username:t.portal_username||"",portal_password:t.portal_password||"",portal_access_enabled:t.portal_access_enabled||!1}),Y(!0),U(null)},re=(t,r)=>{if(!t||!r||t.trim()===""||r.trim()===""){const k=["password","employee","portal","access","secure","user","login","account"],T=k[Math.floor(Math.random()*k.length)],$=Math.floor(Math.random()*9e3)+1e3,C=["!","@","#","$"],P=C[Math.floor(Math.random()*C.length)];return`${T}${$}${P}`}const n=t.charAt(0).toUpperCase(),c=r.charAt(0).toUpperCase(),h=t.substring(0,Math.min(3,t.length)).toLowerCase(),i=r.substring(0,Math.min(2,r.length)).toLowerCase(),p=Math.floor(Math.random()*900)+100,u=["!","@","#","$","%"],j=u[Math.floor(Math.random()*u.length)];return`${n}${c}${h}${i}${p}${j}`},Le=()=>{S({first_name_en:"",last_name_en:"",email:"",phone:"",department:"",job_title:"",employment_status:"active",hire_date:"",portal_username:"",portal_password:"",portal_access_enabled:!1}),J(!0)},Ie=async()=>{try{const{data:t,error:r}=await y.from("companies").select("id").eq("company_name_en","Derayah Financial").maybeSingle();if(r||!t){alert("Company not found. Please contact your administrator.");return}const n=X.length,c=`EMP-${new Date().getFullYear()}-${String(n+1).padStart(3,"0")}`,{data:h,error:i}=await y.from("employees").insert({company_id:t.id,employee_number:c,national_id:`ID${Date.now()}`,first_name_en:l.first_name_en,last_name_en:l.last_name_en,email:l.email,phone:l.phone||null,department:l.department||null,job_title:l.job_title||null,employment_status:l.employment_status,hire_date:l.hire_date||null,portal_username:l.portal_username||null,portal_password:l.portal_password||null,portal_access_enabled:l.portal_access_enabled}).select().single();if(i){console.error("Error creating employee:",i),alert(`Failed to create employee: ${i.message}`);return}if(l.portal_access_enabled&&l.portal_username&&l.portal_password){console.log("Creating auth user for new employee...");try{const{data:p,error:u}=await y.rpc("create_employee_auth_user_auto",{p_employee_id:h.id,p_email:l.email,p_portal_username:l.portal_username,p_portal_password:l.portal_password});u?(console.error("Error creating auth user:",u),alert(`Employee created but portal access setup failed: ${u.message}`)):p&&p.success?(console.log("Portal access enabled:",p),p.requires_manual_auth_creation?alert(`Employee created successfully! Portal access enabled.

To complete the setup, please:
1. Go to Supabase Dashboard > Authentication > Users
2. Click "Add user"
3. Email: ${l.email}
4. Password: ${l.portal_password}
5. Set Email Confirm to true
6. Click "Create user"

After creating the auth user, the employee can log in immediately!`):alert(`Employee created successfully! Portal access enabled. They can now log in using their email: ${l.email}`)):(console.error("Portal access setup failed:",p),alert("Employee created but portal access setup failed. Please enable portal access manually."))}catch(p){console.error("Error in auth user creation:",p),alert("Employee created but portal access setup failed. Please enable portal access manually.")}}else alert("Employee created successfully!");await R(),J(!1)}catch(t){console.error("Error creating employee:",t),alert("Failed to create employee. Please try again.")}},ge=async()=>{if(a)try{const t={national_id:s.national_id||null,first_name_en:s.first_name_en,last_name_en:s.last_name_en,email:s.email,phone:s.phone||null,department:s.department||null,job_title:s.job_title||null,employment_status:s.employment_status,hire_date:s.hire_date||null,portal_username:s.portal_username||null,portal_password:s.portal_password||null,portal_access_enabled:s.portal_access_enabled};if(console.log("Updating employee with data:",t),console.log("Employee ID:",a.id),s.portal_access_enabled&&s.portal_username&&s.portal_password){console.log("Creating auth user for employee portal access...");try{const{data:n,error:c}=await y.rpc("create_employee_auth_user_auto",{p_employee_id:a.id,p_email:s.email,p_portal_username:s.portal_username,p_portal_password:s.portal_password});c?(console.error("Error creating auth user:",c),alert(`Employee updated but portal access setup failed: ${c.message}`)):n&&n.success?(console.log("Portal access enabled:",n),n.requires_manual_auth_creation?alert(`Employee updated successfully! Portal access enabled.

To complete the setup, please:
1. Go to Supabase Dashboard > Authentication > Users
2. Click "Add user"
3. Email: ${s.email}
4. Password: ${s.portal_password}
5. Set Email Confirm to true
6. Click "Create user"

After creating the auth user, the employee can log in immediately!`):alert(`Employee updated successfully! Portal access enabled. They can now log in using their email: ${s.email}`)):(console.error("Portal access setup failed:",n),alert("Employee updated but portal access setup failed. Please enable portal access manually."))}catch(n){console.error("Error in auth user creation:",n),alert("Employee updated but portal access setup failed. Please enable portal access manually.")}}const{error:r}=await y.from("employees").update(t).eq("id",a.id);if(r)throw r;alert("Employee updated successfully!"),ue||(Y(!1),D(null),R())}catch(t){console.error("Error updating employee:",t),console.error("Error details:",t),t&&typeof t=="object"&&"message"in t?alert(`Failed to update employee: ${t.message}`):alert("Failed to update employee. Please check the console for details.")}},Me=async t=>{if(confirm(`Are you sure you want to delete ${t.first_name_en} ${t.last_name_en}?`))try{const{error:r}=await y.from("employees").delete().eq("id",t.id);if(r)throw r;R()}catch(r){console.error("Error deleting employee:",r),alert("Failed to delete employee")}U(null)},Ue=async()=>{var t,r;if(a)try{const{data:{user:n}}=await y.auth.getUser();if(!n)return;const{data:c}=await y.from("company_users").select("company_id, id").eq("user_id",n.id).maybeSingle();if(!c)return;const h={employee_id:a.id,company_id:c.company_id,iban:_.iban||null,bank_name:_.bank_name||null,bank_branch_code:_.bank_branch_code||null,account_holder_name_ar:_.account_holder_name_ar||null,investment_account_number:_.investment_account_number||null,broker_custodian_name:_.broker_custodian_name||null,broker_account_number:_.broker_account_number||null,tadawul_investor_number:_.tadawul_investor_number||null,created_by:c.id};if(m){const{error:i}=await y.from("employee_financial_info").update(h).eq("employee_id",a.id);if(i)if(i.code==="PGRST116"||(t=i.message)!=null&&t.includes("duplicate")){const{error:p}=await y.from("employee_financial_info").upsert(h,{onConflict:"employee_id",ignoreDuplicates:!1});if(p)throw p}else throw i;alert("Financial information updated successfully!")}else{const{error:i}=await y.from("employee_financial_info").insert(h);if(i)if(i.code==="23505"||(r=i.message)!=null&&r.includes("duplicate key")){const{error:p}=await y.from("employee_financial_info").update(h).eq("employee_id",a.id);if(p)throw p;alert("Financial information updated successfully!")}else throw i;else alert("Financial information saved successfully!")}await z(a.id),Q(!1)}catch(n){console.error("Error saving financial info:",n);const c=(n==null?void 0:n.message)||"Unknown error occurred";alert(`Failed to save financial information: ${c}. Please try again.`)}},be=async t=>{if(!(!a||!m))try{const{data:{user:r}}=await y.auth.getUser();if(!r)return;const{data:n}=await y.from("company_users").select("id, role").eq("user_id",r.id).maybeSingle();if(!n||!["super_admin","finance_admin","company_admin"].includes(n.role)){alert("Only finance admins and company admins can verify financial information.");return}const{error:c}=await y.from("employee_financial_info").update({account_status:t,verified_by:n.id,verified_at:new Date().toISOString(),account_verification_date:new Date().toISOString().split("T")[0]}).eq("employee_id",a.id);if(c)throw c;alert(`Financial information ${t==="verified"?"verified":"rejected"} successfully!`),await z(a.id)}catch(r){console.error("Error verifying financial info:",r),alert("Failed to verify financial information. Please try again.")}},Ve=async t=>{if(!t.portal_username||!t.portal_password){alert("Employee must have portal credentials set before sending. Please edit the employee first.");return}if(window.confirm(`Send portal credentials to ${t.first_name_en} ${t.last_name_en} at ${t.email}?`))try{alert(`Portal credentials sent to ${t.email}!

Username: ${t.portal_username}
Password: ${t.portal_password}`),U(null)}catch(r){console.error("Error sending credentials:",r),alert("Failed to send credentials")}},fe={active:"bg-green-100 text-green-800",terminated:"bg-red-100 text-red-800",resigned:"bg-yellow-100 text-yellow-800",retired:"bg-gray-100 text-gray-800"};return we?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:`space-y-6 ${f?"text-right":"text-left"}`,children:[e.jsxs("div",{className:`flex items-center justify-between ${f?"flex-row-reverse":""}`,children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:g("employees.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:g("employees.description")})]}),e.jsxs("div",{className:`flex items-center space-x-3 ${f?"space-x-reverse":""}`,children:[e.jsxs("button",{className:`flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition ${f?"space-x-reverse":""}`,children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:g("employees.importCSV")})]}),e.jsxs("button",{onClick:Le,className:`flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition ${f?"space-x-reverse":""}`,children:[e.jsx(Xe,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:g("employees.addEmployee")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:`flex items-center space-x-4 ${f?"space-x-reverse flex-row-reverse":""}`,children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Be,{className:`absolute ${f?"right-3":"left-3"} top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400`}),e.jsx("input",{type:"text",placeholder:g("employees.searchPlaceholder"),value:M,onChange:t=>Ce(t.target.value),className:`w-full ${f?"pr-10 pl-4 text-right":"pl-10 pr-4 text-left"} py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{className:`flex items-center space-x-2 ${f?"space-x-reverse":""}`,children:[e.jsx(Ge,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:O,onChange:t=>Ee(t.target.value),className:`px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f?"text-right":"text-left"}`,children:[e.jsx("option",{value:"all",children:g("employees.allStatus")}),e.jsx("option",{value:"active",children:g("employees.active")}),e.jsx("option",{value:"terminated",children:g("employees.terminated")}),e.jsx("option",{value:"resigned",children:g("employees.resigned")}),e.jsx("option",{value:"retired",children:g("employees.retired")})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",style:{minWidth:"1200px"},children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0 z-20",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider sticky ${f?"right-0":"left-0"} z-30 bg-gray-50`,children:g("employees.employee")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.employeeNumber")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.department")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.totalShares")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.vested")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.unvested")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.vestingProgress")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.status")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-left":"text-right"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:g("employees.actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:9,className:"px-6 py-12 text-center",children:[e.jsx(He,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium",children:g("employees.noEmployeesFound")}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:g("employees.noEmployeesDesc")})]})}):H.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition group",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap sticky left-0 z-20 bg-white group-hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-medium text-sm",children:[t.first_name_en.charAt(0),t.last_name_en.charAt(0)]})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("button",{onClick:()=>he(t),className:"text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline transition text-left",children:[t.first_name_en," ",t.last_name_en]}),e.jsx("p",{className:"text-xs text-gray-500",children:t.job_title||"N/A"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:t.employee_number})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:t.department||"Unassigned"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.total_shares?t.total_shares.toLocaleString():"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-green-600",children:t.vested_shares?t.vested_shares.toLocaleString():"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:t.unvested_shares?t.unvested_shares.toLocaleString():"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"w-32",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:[t.vesting_progress?t.vesting_progress.toFixed(0):"0","%"]})}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${t.vesting_progress||0}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${fe[t.employment_status]}`,children:t.employment_status})}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap ${f?"text-left":"text-right"}`,children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:r=>{const c=r.currentTarget.getBoundingClientRect(),h=180,i=window.innerHeight-c.bottom,p=c.top;let u;i>=h+10?u=c.bottom+8:p>=h+10?u=c.top-h+5:u=window.innerHeight-h-10,De({top:u,left:c.right-192}),U(ie===t.id?null:t.id)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition",children:e.jsx(ze,{className:"w-4 h-4"})}),ie===t.id&&Z&&e.jsxs("div",{ref:ee,className:"fixed w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-[9999]",style:{top:`${Z.top}px`,left:`${Z.left}px`},children:[e.jsxs("button",{onClick:()=>he(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-gray-700 hover:bg-gray-50 rounded-t-lg transition`,children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:g("employees.view")})]}),e.jsxs("button",{onClick:()=>Te(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-gray-700 hover:bg-gray-50 transition`,children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:g("employees.edit")})]}),e.jsxs("button",{onClick:()=>Ve(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-blue-600 hover:bg-blue-50 transition`,children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{children:g("employees.sendCredentials")})]}),e.jsxs("button",{onClick:()=>Me(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-red-600 hover:bg-red-50 rounded-b-lg transition`,children:[e.jsx(Oe,{className:"w-4 h-4"}),e.jsx("span",{children:g("employees.delete")})]})]})]})})]},t.id))})]})}),H.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",H.length," of ",X.length," employees"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-200 rounded transition",children:"Previous"}),e.jsx("button",{className:"px-3 py-1 text-sm bg-blue-600 text-white rounded",children:"1"}),e.jsx("button",{className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-200 rounded transition",children:"2"}),e.jsx("button",{className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-200 rounded transition",children:"Next"})]})]})})]}),Se&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t=>{t.target===t.currentTarget&&(B(!1),L(!1),D(null))},children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[a.first_name_en," ",a.last_name_en]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Employee #",a.employee_number]})]}),e.jsx("button",{onClick:()=>{B(!1),L(!1),D(null)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition","aria-label":"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex space-x-8 px-6",children:[e.jsx("button",{onClick:()=>K("details"),className:`py-4 border-b-2 font-medium text-sm transition ${G==="details"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Employee Details"}),e.jsx("button",{onClick:()=>K("financial"),className:`py-4 border-b-2 font-medium text-sm transition ${G==="financial"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Financial Overview"})]})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[G==="details"&&e.jsxs("div",{className:"space-y-6",children:[ue?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Number"}),e.jsx("p",{className:"text-gray-900 font-mono",children:a.employee_number}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cannot be changed"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["National/Iqama ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.national_id||"",onChange:t=>x({...s,national_id:t.target.value}),placeholder:"Enter National/Iqama ID",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.first_name_en,onChange:t=>x({...s,first_name_en:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.last_name_en,onChange:t=>x({...s,last_name_en:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:s.email,onChange:t=>x({...s,email:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"text",value:s.phone,onChange:t=>x({...s,phone:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",value:s.department,onChange:t=>x({...s,department:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title"}),e.jsx("input",{type:"text",value:s.job_title,onChange:t=>x({...s,job_title:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Status"}),e.jsxs("select",{value:s.employment_status,onChange:t=>x({...s,employment_status:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"resigned",children:"Resigned"}),e.jsx("option",{value:"retired",children:"Retired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hire Date"}),e.jsx("input",{type:"date",value:s.hire_date,onChange:t=>x({...s,hire_date:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"portal_access_enabled",checked:s.portal_access_enabled,onChange:t=>x({...s,portal_access_enabled:t.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"portal_access_enabled",className:"text-sm font-medium text-gray-700",children:"Enable Portal Access"})]}),s.portal_access_enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Portal Username"}),e.jsx("input",{type:"text",value:s.portal_username,onChange:t=>x({...s,portal_username:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Portal Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:F?"text":"password",value:s.portal_password,onChange:t=>x({...s,portal_password:t.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{type:"button",onClick:()=>ae(!F),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",title:F?"Hide password":"Show password",children:e.jsx(W,{className:"w-5 h-5"})})]}),e.jsxs("button",{type:"button",onClick:()=>{const t=re(s.first_name_en,s.last_name_en);x({...s,portal_password:t})},className:"mt-2 w-full px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2",title:"Generate password based on employee name",children:[e.jsx(ne,{className:"w-4 h-4"}),"Generate Password"]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2 pt-4 border-t border-gray-200",children:[e.jsxs("button",{onClick:()=>{L(!0),x({national_id:a.national_id||"",first_name_en:a.first_name_en,last_name_en:a.last_name_en,email:a.email,phone:a.phone||"",department:a.department||"",job_title:a.job_title||"",employment_status:a.employment_status,hire_date:a.hire_date||"",portal_username:a.portal_username||"",portal_password:a.portal_password||"",portal_access_enabled:a.portal_access_enabled||!1})},className:"px-4 py-2 text-sm bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{L(!1),x({national_id:a.national_id||"",first_name_en:a.first_name_en,last_name_en:a.last_name_en,email:a.email,phone:a.phone||"",department:a.department||"",job_title:a.job_title||"",employment_status:a.employment_status,hire_date:a.hire_date||"",portal_username:a.portal_username||"",portal_password:a.portal_password||"",portal_access_enabled:a.portal_access_enabled||!1})},className:"px-4 py-2 text-sm bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:"Cancel"}),e.jsx("button",{onClick:async()=>{await ge(),L(!1),await R();const t=X.find(r=>r.id===a.id);t&&(D(t),await z(t.id))},className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Save Changes"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Employee Number"}),e.jsx("p",{className:"text-gray-900",children:a.employee_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"National/Iqama ID"}),e.jsx("p",{className:"text-gray-900 font-mono",children:a.national_id?`ID: ${String(a.national_id).padStart(9,"0")}`:"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Employment Status"}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${fe[a.employment_status]}`,children:a.employment_status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Hire Date"}),e.jsx("p",{className:"text-gray-900",children:a.hire_date?V(a.hire_date):"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"First Name"}),e.jsx("p",{className:"text-gray-900",children:a.first_name_en})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Last Name"}),e.jsx("p",{className:"text-gray-900",children:a.last_name_en})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:a.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Phone"}),e.jsx("p",{className:"text-gray-900",children:a.phone||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Department"}),e.jsx("p",{className:"text-gray-900",children:a.department||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Job Title"}),e.jsx("p",{className:"text-gray-900",children:a.job_title||"N/A"})]})]}),e.jsx("div",{className:"flex justify-start pt-4 border-t border-gray-200",children:e.jsxs("button",{onClick:()=>{L(!0),x({national_id:a.national_id||"",first_name_en:a.first_name_en,last_name_en:a.last_name_en,email:a.email,phone:a.phone||"",department:a.department||"",job_title:a.job_title||"",employment_status:a.employment_status,hire_date:a.hire_date||"",portal_username:a.portal_username||"",portal_password:a.portal_password||"",portal_access_enabled:a.portal_access_enabled||!1})},className:"px-4 py-2 text-sm bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Edit"]})})]}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Banking & Investment Accounts"}),e.jsxs("div",{className:"flex gap-2",children:[(m==null?void 0:m.account_status)==="verified"&&e.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"✓ Verified"}),(m==null?void 0:m.account_status)==="pending"&&e.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"⏳ Pending"}),(m==null?void 0:m.account_status)==="rejected"&&e.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:"✗ Rejected"}),me?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Ue,className:"px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"Save"}),e.jsx("button",{onClick:()=>{Q(!1),m&&A({iban:m.iban||"",bank_name:m.bank_name||"",bank_branch_code:m.bank_branch_code||"",account_holder_name_ar:m.account_holder_name_ar||"",investment_account_number:m.investment_account_number||"",broker_custodian_name:m.broker_custodian_name||"",broker_account_number:m.broker_account_number||"",tadawul_investor_number:m.tadawul_investor_number||""})},className:"px-4 py-2 text-sm bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:"Cancel"})]}):e.jsx("button",{onClick:()=>Q(!0),className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:m?"Edit":"Add Financial Info"})]})]}),me?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Banking Information (for Cash Transfers)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["IBAN ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:_.iban,onChange:t=>A({..._,iban:t.target.value}),placeholder:"SAXX XXXX XXXX XXXX XXXX XXXX",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",value:_.bank_name,onChange:t=>A({..._,bank_name:t.target.value}),placeholder:"e.g., Al Rajhi Bank",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Code"}),e.jsx("input",{type:"text",value:_.bank_branch_code,onChange:t=>A({..._,bank_branch_code:t.target.value}),placeholder:"Branch code",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Holder Name (Arabic)"}),e.jsx("input",{type:"text",value:_.account_holder_name_ar,onChange:t=>A({..._,account_holder_name_ar:t.target.value}),placeholder:"الاسم بالعربية",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",dir:"rtl"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Investment Account Information (for Share Transfers)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Investment Account Number (Nostro)"}),e.jsx("input",{type:"text",value:_.investment_account_number,onChange:t=>A({..._,investment_account_number:t.target.value}),placeholder:"Custody account number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Broker/Custodian Name"}),e.jsx("input",{type:"text",value:_.broker_custodian_name,onChange:t=>A({..._,broker_custodian_name:t.target.value}),placeholder:"e.g., NCB Capital, Al Rajhi Capital",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Broker Account Number"}),e.jsx("input",{type:"text",value:_.broker_account_number,onChange:t=>A({..._,broker_account_number:t.target.value}),placeholder:"Broker account number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tadawul Investor Number"}),e.jsx("input",{type:"text",value:_.tadawul_investor_number,onChange:t=>A({..._,tadawul_investor_number:t.target.value}),placeholder:"Tadawul investor number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})]}):e.jsx("div",{className:"space-y-6",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Banking Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"IBAN"}),e.jsx("p",{className:"text-gray-900",children:m.iban||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Bank Name"}),e.jsx("p",{className:"text-gray-900",children:m.bank_name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Branch Code"}),e.jsx("p",{className:"text-gray-900",children:m.bank_branch_code||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Account Holder (Arabic)"}),e.jsx("p",{className:"text-gray-900",dir:"rtl",children:m.account_holder_name_ar||"Not provided"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Investment Account Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Investment Account Number"}),e.jsx("p",{className:"text-gray-900 font-mono text-sm",children:m.investment_account_number?"••••••••":"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Broker/Custodian"}),e.jsx("p",{className:"text-gray-900",children:m.broker_custodian_name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Broker Account Number"}),e.jsx("p",{className:"text-gray-900 font-mono text-sm",children:m.broker_account_number?"••••••••":"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Tadawul Investor Number"}),e.jsx("p",{className:"text-gray-900",children:m.tadawul_investor_number||"Not provided"})]})]})]}),m.account_verification_date&&e.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Verified on ",V(m.account_verification_date)]})}),m.account_status==="pending"&&e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>be("verified"),className:"px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"✓ Verify Account"}),e.jsx("button",{onClick:()=>be("rejected"),className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"✗ Reject"})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:'No financial information available. Click "Add Financial Info" to add banking and investment account details.'})})})]})})]}),G==="financial"&&e.jsx("div",{className:"space-y-6",children:Fe?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-gray-500",children:"Loading financial data..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6 border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Financial Overview"}),e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Granted Shares"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((ye=d==null?void 0:d.total_shares)==null?void 0:ye.toLocaleString())||"0"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Vested Shares"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:((_e=d==null?void 0:d.vested_shares)==null?void 0:_e.toLocaleString())||"0"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Unvested Shares"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:((je=d==null?void 0:d.unvested_shares)==null?void 0:je.toLocaleString())||"0"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Value"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:d!=null&&d.market_value?`${d.market_value.toLocaleString()} SAR`:"N/A"})]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"transform -rotate-90 w-32 h-32",children:[e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"#e5e7eb",strokeWidth:"16",fill:"none"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"#10b981",strokeWidth:"16",fill:"none",strokeDasharray:`${((d==null?void 0:d.vested_shares)||0)/((d==null?void 0:d.total_shares)||1)*351.86} 351.86`,strokeLinecap:"round"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"#3b82f6",strokeWidth:"16",fill:"none",strokeDasharray:`${((d==null?void 0:d.unvested_shares)||0)/((d==null?void 0:d.total_shares)||1)*351.86} 351.86`,strokeDashoffset:`-${((d==null?void 0:d.vested_shares)||0)/((d==null?void 0:d.total_shares)||1)*351.86}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Vesting"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:(d==null?void 0:d.total_shares)>0?`${(((d==null?void 0:d.vested_shares)||0)/d.total_shares*100).toFixed(0)}%`:"0%"})]})]}),e.jsxs("div",{className:"mt-3 space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-gray-600",children:"Vested"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-gray-600",children:"Unvested"})]})]})]})]})]}),q.length>0&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-gradient-to-b from-gray-50 to-white",children:[e.jsx("div",{className:"mb-4 flex justify-between items-center",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Grant Timeline"})}),e.jsx("div",{className:"space-y-4",children:(()=>{const t=q.filter(o=>o.vesting_start_date&&o.vesting_end_date&&(o.status==="active"||o.status==="pending_signature"));if(t.length===0)return null;const r=t.flatMap(o=>[new Date(o.vesting_start_date),new Date(o.vesting_end_date)]),n=new Date(Math.min(...r.map(o=>o.getTime()))),c=new Date(Math.max(...r.map(o=>o.getTime()))),h=n,i=c,p=i.getTime()-h.getTime(),u=o=>(new Date(o).getTime()-h.getTime())/p*100,j=()=>{const o=[],k=h.getFullYear(),T=i.getFullYear();for(let $=k;$<=T;$++){let C=0;const P=new Date($,0,1);P>=h&&P<=i?C=u(P.toISOString().split("T")[0]):$===k?C=-5:$===T?C=100:C=($-k)/(T-k)*100,o.push({year:$,position:C})}return o};return e.jsxs(e.Fragment,{children:[t.map(o=>{var I;const k=u(o.vesting_start_date),$=u(o.vesting_end_date)-k,C=o.computed_vested_shares||Number(o.vested_shares)||0,P=Number(o.total_shares)||0,w=P>0?C/P*100:0,N=((I=o.incentive_plans)==null?void 0:I.plan_name_en)||"Unknown Plan";return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-40 text-sm font-medium text-gray-700 truncate",title:N,children:N}),e.jsxs("div",{className:"text-xs text-gray-500 ml-2 mr-4",children:[P.toLocaleString(),"/",C.toLocaleString()," shares"]}),e.jsx("div",{className:"relative h-8 flex-1 cursor-pointer",onMouseEnter:v=>{pe(o.id);const E=v.currentTarget.getBoundingClientRect();se({x:E.left+E.width/2,y:E.top-10})},onMouseMove:v=>{const E=v.currentTarget.getBoundingClientRect();se({x:v.clientX,y:E.top-10})},onMouseLeave:()=>{pe(null),se(null)},children:e.jsxs("div",{className:"absolute inset-y-0 left-0 flex rounded-lg overflow-hidden",style:{width:`${$}%`,left:`${k}%`},children:[w>0&&e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-300 h-full flex items-center justify-center",style:{width:`${w}%`},children:e.jsx("span",{className:"text-xs font-semibold text-white px-2 truncate",children:w>=15?`${Math.floor(w)}%`:""})}),e.jsx("div",{className:"bg-gradient-to-r from-gray-200 to-gray-100 h-full flex items-center justify-center",style:{width:`${100-w}%`},children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Future"})})]})})]})},o.id)}),e.jsxs("div",{className:"flex items-center mt-4",children:[e.jsx("div",{className:"w-40"}),e.jsx("div",{className:"ml-2 mr-4",children:e.jsx("div",{className:"w-20"})}),e.jsx("div",{className:"relative h-6 flex-1 border-t-2 border-gray-300",children:e.jsx("div",{className:"absolute inset-x-0 -top-4",children:j().map((o,k)=>e.jsx("div",{className:"absolute text-xs text-gray-600 font-medium",style:{left:`${o.position}%`,transform:"translateX(-50%)"},children:o.year},k))})})]})]})})()}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-blue-400"}),e.jsx("span",{className:"text-gray-700",children:"Vested"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-200"}),e.jsx("span",{className:"text-gray-700",children:"Unvested"})]})]})]}),xe&&te&&(()=>{var j;const t=q.find(o=>o.id===xe);if(!t)return null;const r=t.computed_vested_shares||Number(t.vested_shares)||0,n=Number(t.total_shares)||0,c=n-r,h=n>0?r/n*100:0,i=((j=t.incentive_plans)==null?void 0:j.plan_name_en)||"Unknown Plan",p=t.total_transferred||0,u=t.total_exercised||0;return e.jsxs("div",{className:"fixed z-50 bg-gray-900 text-white text-sm rounded-lg px-4 py-3 shadow-xl pointer-events-none whitespace-nowrap",style:{left:`${te.x}px`,top:`${te.y}px`,transform:"translate(-50%, -100%)"},children:[e.jsx("div",{className:"font-semibold text-base mb-2",children:i}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Total Shares:"}),e.jsx("span",{className:"font-medium",children:n.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Vested:"}),e.jsxs("span",{className:"font-medium text-green-400",children:[r.toLocaleString()," (",h.toFixed(1),"%)"]})]}),p>0&&e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Transferred:"}),e.jsx("span",{className:"font-medium text-purple-400",children:p.toLocaleString()})]}),u>0&&e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Exercised:"}),e.jsx("span",{className:"font-medium text-orange-400",children:u.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Unvested:"}),e.jsxs("span",{className:"font-medium text-blue-400",children:[c.toLocaleString()," (",(100-h).toFixed(1),"%)"]})]}),e.jsx("div",{className:"border-t border-gray-700 pt-1 mt-1",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Period:"}),e.jsxs("span",{className:"font-medium",children:[V(t.vesting_start_date)," - ",V(t.vesting_end_date)]})]})})]})]})})(),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Active Grants"}),q.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No grants found for this employee"}):e.jsx("div",{className:"space-y-3",children:q.map(t=>{var r;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:((r=t.incentive_plans)==null?void 0:r.plan_name_en)||"Unknown Plan"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Grant Date: ",V(t.grant_date)]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.status==="active"?"bg-green-100 text-green-800":t.status==="vested"?"bg-blue-100 text-blue-800":t.status==="expired"?"bg-red-100 text-red-800":(t.status==="cancelled","bg-gray-100 text-gray-800")}`,children:t.status})]}),(()=>{var c,h,i,p;const n=t.computed_vested_shares||Number(t.vested_shares)||0;return e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Total Shares"}),e.jsx("p",{className:"font-semibold text-gray-900",children:(c=Number(t.total_shares))==null?void 0:c.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Vested Shares"}),e.jsx("p",{className:"font-semibold text-gray-900",children:n.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Exercise Price"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[(i=Number((h=t.incentive_plans)==null?void 0:h.exercise_price))==null?void 0:i.toLocaleString()," SAR"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Total Value"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[(n*(Number((p=t.incentive_plans)==null?void 0:p.exercise_price)||0)).toLocaleString()," SAR"]})]})]})})(),t.vesting_end_date&&t.total_shares&&(()=>{const c=(t.computed_vested_shares||Number(t.vested_shares)||0)/Number(t.total_shares)*100;return e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Vesting Progress"}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[c.toFixed(1),"%"]})]}),e.jsx("div",{className:"mt-2 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-blue-600 h-full transition-all",style:{width:`${c}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Vesting ends: ",V(t.vesting_end_date)]})]})})()]},t.id)})})]})]})})]}),e.jsx("div",{className:"flex-shrink-0 p-6 border-t border-gray-200 bg-white flex items-center justify-end",children:e.jsx("button",{onClick:()=>{B(!1),L(!1),D(null),oe([]),de(null)},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Close"})})]})}),$e&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Employee"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["National/Iqama ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.national_id||"",onChange:t=>x({...s,national_id:t.target.value}),placeholder:"Enter National/Iqama ID",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee Number"}),e.jsx("p",{className:"px-4 py-2 text-gray-600 bg-gray-50 rounded-lg border border-gray-200",children:a.employee_number}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cannot be changed"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:s.first_name_en,onChange:t=>x({...s,first_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:s.last_name_en,onChange:t=>x({...s,last_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:s.email,onChange:t=>x({...s,email:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:s.phone,onChange:t=>x({...s,phone:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:s.department,onChange:t=>x({...s,department:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Title"}),e.jsx("input",{type:"text",value:s.job_title,onChange:t=>x({...s,job_title:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Status"}),e.jsxs("select",{value:s.employment_status,onChange:t=>x({...s,employment_status:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"resigned",children:"Resigned"}),e.jsx("option",{value:"retired",children:"Retired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hire Date"}),e.jsx("input",{type:"date",value:s.hire_date,onChange:t=>x({...s,hire_date:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Employee Portal Credentials"}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"portal_access_enabled",checked:s.portal_access_enabled,onChange:t=>x({...s,portal_access_enabled:t.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"portal_access_enabled",className:"text-sm font-medium text-gray-700",children:"Enable Employee Portal Access"})]}),s.portal_access_enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Username"}),e.jsx("input",{type:"text",value:s.portal_username,onChange:t=>x({...s,portal_username:t.target.value}),placeholder:"Enter username for employee portal",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:F?"text":"password",value:s.portal_password,onChange:t=>x({...s,portal_password:t.target.value}),placeholder:"Enter password for employee portal",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{type:"button",onClick:()=>ae(!F),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",title:F?"Hide password":"Show password",children:e.jsx(W,{className:"w-5 h-5"})})]}),e.jsxs("button",{type:"button",onClick:()=>{const t=re(s.first_name_en,s.last_name_en);x({...s,portal_password:t})},className:"mt-2 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2",title:"Generate password based on employee name",children:[e.jsx(ne,{className:"w-4 h-4"}),"Generate Password"]})]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 p-6 border-t border-gray-200 bg-white flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{Y(!1),D(null)},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsx("button",{onClick:ge,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Save Changes"})]})]})}),Pe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Employee"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:l.first_name_en,onChange:t=>S({...l,first_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:l.last_name_en,onChange:t=>S({...l,last_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:l.email,onChange:t=>{const r=t.target.value;r!=="superadmin@derayah.com"&&S({...l,email:r,portal_username:l.portal_access_enabled?r:l.portal_username})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"employee@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:l.phone,onChange:t=>S({...l,phone:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:l.department,onChange:t=>S({...l,department:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Title"}),e.jsx("input",{type:"text",value:l.job_title,onChange:t=>S({...l,job_title:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Status"}),e.jsxs("select",{value:l.employment_status,onChange:t=>S({...l,employment_status:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"resigned",children:"Resigned"}),e.jsx("option",{value:"retired",children:"Retired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hire Date"}),e.jsx("input",{type:"date",value:l.hire_date,onChange:t=>S({...l,hire_date:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Employee Portal Access"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("input",{type:"checkbox",id:"portal_access_enabled",checked:l.portal_access_enabled,onChange:t=>{const r=t.target.checked;if(r&&!l.email){alert("Please add employee email first before enabling portal access.");return}if(r&&l.email==="superadmin@derayah.com"){alert("Cannot use superadmin@derayah.com as employee email.");return}S({...l,portal_access_enabled:r,portal_username:r&&l.email?l.email:l.portal_username})},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"portal_access_enabled",className:"text-sm font-medium text-gray-700",children:"Enable Employee Portal Access"})]}),l.portal_access_enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Username"}),e.jsx("input",{type:"text",value:l.portal_username&&l.portal_username!=="superadmin@derayah.com"?l.portal_username:l.email||"",onChange:t=>{const r=t.target.value;r!=="superadmin@derayah.com"&&S({...l,portal_username:r})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:l.email||"employee@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:F?"text":"password",value:l.portal_password,onChange:t=>S({...l,portal_password:t.target.value}),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter password for portal access"}),e.jsx("button",{type:"button",onClick:()=>ae(!F),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",title:F?"Hide password":"Show password",children:e.jsx(W,{className:"w-5 h-5"})})]}),e.jsxs("button",{type:"button",onClick:()=>{const t=re(l.first_name_en,l.last_name_en);S({...l,portal_password:t})},className:"mt-2 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2",title:"Generate password based on employee name",children:[e.jsx(ne,{className:"w-4 h-4"}),"Generate Password"]})]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 p-6 border-t border-gray-200 bg-white flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:()=>J(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsx("button",{onClick:Ie,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Create Employee"})]})]})})]})}export{et as default};

import{s as M,j as e}from"./index-DDk1oefv.js";import{r as f}from"./react-vendor-xiFAdxLt.js";import{P as we}from"./PortfolioValuation-i0FtqGxd.js";import{P as Se}from"./PerformanceChart-BZD8oqtv.js";import{V as De}from"./VestingEventsCalendar-DSWlnWnV.js";import{C as ee,c as Ee,b as F,a as Ve,U as Le}from"./ui-vendor-B0ZOy8uN.js";import"./supabase-vendor-B-LuImWU.js";function Fe(){var X,J;const[te,se]=f.useState(null),[ae,re]=f.useState(!0),[ne,le]=f.useState(""),[Y,ie]=f.useState(30),[de,B]=f.useState(!1),[C,H]=f.useState(null),[oe,ce]=f.useState(""),[P,I]=f.useState("number"),[O,me]=f.useState([]),[b,z]=f.useState(null),[xe,U]=f.useState(!1);f.useEffect(()=>{W()},[]);const he=async t=>{try{const r=await fetch(`https://dataportal.saudiexchange.sa/wps/portal/tadawul/markets/equities/main-board/${t}`,{mode:"no-cors"});return console.log("Fetching Tadawul price for:",t),30}catch(r){return console.error("Error fetching Tadawul price:",r),30}},W=async()=>{var t,r,i;try{const{data:{user:d}}=await M.auth.getUser();if(!d){console.log("No authenticated user, redirecting to login..."),window.location.href="/employee/login";return}const{data:l,error:o}=await M.from("employees").select("id, company_id, first_name_en, last_name_en, email, user_id").eq("user_id",d.id).maybeSingle();if(o||!l){console.error("Error loading employee data:",o),window.location.href="/employee/login";return}console.log("Loading data for employee:",l);const[x,h,y]=await Promise.all([M.from("grants").select(`
            id, 
            total_shares, 
            vested_shares, 
            remaining_unvested_shares, 
            status, 
            grant_number, 
            grant_date,
            vesting_start_date,
            vesting_end_date,
            employee_acceptance_at,
            generated_documents (
              id,
              status,
              document_type,
              approved_at,
              approved_by
            ),
            incentive_plans(plan_name_en, plan_type)
          `).eq("employee_id",l.id),M.from("companies").select("tadawul_symbol, current_fmv, fmv_source").eq("id",l.company_id).maybeSingle(),M.from("vesting_events").select(`
            id,
            grant_id,
            employee_id,
            vesting_date,
            shares_to_vest,
            status,
            event_type,
            sequence_number,
            performance_condition_met,
            performance_notes,
            processed_at,
            processed_by,
            grants (
              id,
              grant_number,
              incentive_plans (
                plan_name_en,
                plan_code,
                plan_type
              )
            )
          `).eq("employee_id",l.id).order("vesting_date",{ascending:!0})]);let c=0,m=0,u=0,S=0,D=null,v=[];const V=x.data||[],$=y.data||[];y.error&&console.error("Error loading vesting events:",y.error);const pe=[l.first_name_en,l.last_name_en].filter(Boolean).join(" ").trim()||l.email,ve=$.map(g=>{var L,A,R;const p=(L=g.grants)==null?void 0:L.incentive_plans,j=new Date(g.vesting_date),N=new Date,E=j.getTime()-N.setHours(0,0,0,0),k=Math.max(0,Math.ceil(E/(1e3*60*60*24)));return{...g,employee_name:pe,plan_name:(p==null?void 0:p.plan_name_en)||((A=g.grants)==null?void 0:A.grant_number)||"Grant",plan_code:(p==null?void 0:p.plan_code)||((R=g.grants)==null?void 0:R.grant_number)||"",plan_type:(p==null?void 0:p.plan_type)||"ESOP",days_remaining:k,can_exercise:g.status==="due"||g.status==="pending",requires_exercise:!1}});if(V.length>0){c=V.reduce((a,n)=>a+Number(n.total_shares),0);const g=V.reduce((a,n)=>a+Number(n.vested_shares||0),0),p=$.reduce((a,n)=>{var w;const _=(w=n.status)==null?void 0:w.toLowerCase();return _==="due"||_==="transferred"||_==="exercised"?a+Number(n.shares_to_vest||0):a},0);m=g+p,u=c-m,S=V.filter(a=>a.status==="lapsed").reduce((a,n)=>a+Number(n.total_shares||0),0);const j=V.filter(a=>a.status==="active"&&a.vesting_end_date);j.length>0&&(D=j.map(n=>new Date(n.vesting_end_date)).filter(n=>n>new Date).sort((n,_)=>n.getTime()-_.getTime())[0]||null);const N=((t=h.data)==null?void 0:t.current_fmv)!==null&&((r=h.data)==null?void 0:r.current_fmv)!==void 0?Number(h.data.current_fmv):null;let E=30;if((i=h.data)!=null&&i.tadawul_symbol){const a=await he(h.data.tadawul_symbol);typeof a=="number"&&!Number.isNaN(a)?E=a:N!==null&&!Number.isNaN(N)&&(E=N)}else N!==null&&!Number.isNaN(N)&&(E=N);ie(E);const k=new Date().getFullYear(),L=E,A=V.filter(a=>a.status==="active"),R=A.reduce((a,n)=>{const _=Number(n.total_shares||0),w=Number(n.vested_shares||0);return a+(_-w)},0),K=new Date;K.setHours(0,0,0,0);const G=new Set;$.forEach(a=>{const _=new Date(a.vesting_date).getFullYear();G.add(_)});const ye=G.size>0?Math.min(...Array.from(G)):k,fe=G.size>0?Math.max(...Array.from(G)):k,je=Math.min(k,ye),_e=Math.max(k+4,fe);v=[];for(let a=je;a<=_e;a++)v.push({year:String(a),unvestedShares:0,unvestedValuation:0,vestedShares:0,vestedValuation:0});if($.forEach(a=>{const n=new Date(a.vesting_date),_=n.getFullYear(),w=Number(a.shares_to_vest||0);if(w<=0)return;const Ne=_,T=v.findIndex(Z=>parseInt(Z.year)===Ne);T>=0&&(n<K||a.status==="vested"||a.status==="transferred"||a.status==="exercised"||a.status==="due"?(v[T].vestedShares+=w,v[T].vestedValuation+=w*L):a.status!=="lapsed"&&(v[T].unvestedShares+=w,v[T].unvestedValuation+=w*L))}),v.reduce((a,n)=>a+n.unvestedShares+n.vestedShares,0)===0&&R>0){const a=R/5;v=v.map(n=>({...n,unvestedShares:Math.floor(a),unvestedValuation:Math.floor(a*L)}))}console.log("Grant Data:",{total_shares:c,vested_shares:m,remaining_unvested_shares:u,totalUnvestedShares:R,allActiveGrants:A.length,roadmapData:v,fmvPerShare:L,vestingEventsCount:$.length,roadmapTotalShares:v.reduce((a,n)=>a+n.unvestedShares+n.vestedShares,0)})}const be=V.map(g=>{const p=Array.isArray(g.generated_documents)?g.generated_documents:[],j=p.find(E=>E.document_type==="grant_agreement")||p[0],N=(j==null?void 0:j.status)||g.status||"draft";return{...g,document_status:N,contract_document_id:(j==null?void 0:j.id)||null}});h.data&&le(h.data.tadawul_symbol),se({grants:be,total_shares:c,vested_shares:m,remaining_unvested_shares:u,total_lapsed:S,next_vesting_date:D,roadmapData:v}),me(ve)}catch(d){console.error("Error loading employee data:",d)}finally{re(!1)}},ue=t=>{H(t);const r=sessionStorage.getItem("employee"),i=r?JSON.parse(r):{},d=`
EMPLOYEE STOCK GRANT AGREEMENT

Grant Number: ${t.grant_number}
Employee: ${i.first_name_en} ${i.last_name_en}
Email: ${i.email}
Date: ${new Date().toLocaleDateString()}

GRANT TERMS:
- Total Shares: ${Number(t.total_shares).toLocaleString()}
- Grant Date: ${new Date().toLocaleDateString()}
- Vesting Schedule: 4 years with 1-year cliff
- Vesting Start Date: ${new Date().toLocaleDateString()}
- Vesting End Date: ${new Date(Date.now()+4*365*24*60*60*1e3).toLocaleDateString()}

VESTING SCHEDULE:
- 25% vests after 1 year (cliff)
- Remaining 75% vests monthly over 3 years

CONDITIONS:
1. Employment must continue for shares to vest
2. Shares subject to company's equity plan
3. Tax implications apply per local regulations
4. Shares may be subject to transfer restrictions

ACCEPTANCE:
By signing below, the employee acknowledges receipt and understanding of this grant agreement.

Employee Signature: _________________ Date: _________

Company Representative: _________________ Date: _________

This agreement is subject to the terms and conditions of the company's equity incentive plan.
    `.trim();ce(d),B(!0)},ge=async()=>{if(C)try{const t=new Date(C.grant_date||new Date),r=new Date,i=Number(C.total_shares)||0,d=Math.max(0,(r.getFullYear()-t.getFullYear())*12+(r.getMonth()-t.getMonth()));let l=0;if(d>=12){const y=Math.floor(i*.25),m=(i-y)/36,u=Math.min(d-12,36);l=y+m*u}l=Math.min(l,i);const o=i-l,{error:x}=await M.from("grants").update({status:"active",employee_acceptance_at:new Date().toISOString(),vested_shares:Math.floor(l),remaining_unvested_shares:Math.floor(o)}).eq("id",C.id);if(x){console.error("Error accepting contract:",x),alert("Failed to accept contract. Please try again.");return}const{error:h}=await M.from("generated_documents").update({status:"signed"}).eq("grant_id",C.id);h&&console.error("Error updating document status:",h),B(!1),H(null),await W(),alert(`Contract accepted successfully! Your grant is now active.

Vested shares: ${Math.floor(l).toLocaleString()}
Remaining unvested: ${Math.floor(o).toLocaleString()}`)}catch(t){console.error("Error accepting contract:",t),alert("Failed to accept contract. Please try again.")}};if(ae)return e.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"calc(100vh - 200px)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Loading your dashboard..."})]})});const s=te||{grants:[],total_shares:0,vested_shares:0,remaining_unvested_shares:0,total_lapsed:0,next_vesting_date:null,roadmapData:[]},Q=s.grants.filter(t=>{var i,d,l,o;return t.employee_acceptance_at?!1:(((d=(i=t.document_status)==null?void 0:i.toLowerCase)==null?void 0:d.call(i))||((o=(l=t.status)==null?void 0:l.toLowerCase)==null?void 0:o.call(l))||"")==="pending_signature"});console.log("Display Grant Data Roadmap:",s.roadmapData);const q=({data:t,size:r=60})=>{const i=t.reduce((c,m)=>c+m.value,0);if(i===0)return e.jsx("div",{className:`w-${r/4} h-${r/4} rounded-full bg-gray-200`});let d=0;const l=r/2-2,o=r/2,x=r/2,h=(c,m)=>{const u=y(o,x,l,m),S=y(o,x,l,c),D=m-c<=180?"0":"1";return`M ${o} ${x} L ${u.x} ${u.y} A ${l} ${l} 0 ${D} 0 ${S.x} ${S.y} Z`},y=(c,m,u,S)=>{const D=(S-90)*Math.PI/180;return{x:c+u*Math.cos(D),y:m+u*Math.sin(D)}};return e.jsx("svg",{width:r,height:r,className:"transform -rotate-90",children:t.map((c,m)=>{const u=c.value/i*100,S=d*3.6,D=(d+u)*3.6;return d+=u,e.jsx("path",{d:h(S,D),fill:c.color,stroke:"white",strokeWidth:"1"},m)})})};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Welcome to Your Equity Portal"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Track and manage your equity compensation"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl shadow-lg p-6 text-white",children:[e.jsx("p",{className:"text-blue-100 mb-2",children:"Total Shares Granted"}),e.jsx("p",{className:"text-4xl font-bold",children:s.total_shares.toLocaleString()}),e.jsxs("p",{className:"text-blue-200 text-sm mt-2",children:[s.grants.length," ",s.grants.length===1?"Grant":"Grants"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 rounded-xl shadow-lg p-6 text-white",children:[e.jsx("p",{className:"text-green-100 mb-2",children:"Vested Shares"}),e.jsx("p",{className:"text-4xl font-bold",children:s.vested_shares.toLocaleString()}),e.jsxs("p",{className:"text-green-200 text-sm mt-2",children:[s.total_shares>0?(s.vested_shares/s.total_shares*100).toFixed(1):"0","% of total"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 rounded-xl shadow-lg p-6 text-white",children:[e.jsx("p",{className:"text-purple-100 mb-2",children:"Unvested Shares"}),e.jsx("p",{className:"text-4xl font-bold",children:s.remaining_unvested_shares.toLocaleString()}),e.jsxs("p",{className:"text-purple-200 text-sm mt-2",children:[s.total_shares>0?(s.remaining_unvested_shares/s.total_shares*100).toFixed(1):"0","% remaining"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4",children:[e.jsx("button",{onClick:()=>I("number"),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${P==="number"?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Number"}),e.jsx("button",{onClick:()=>I("valuation"),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${P==="valuation"?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Valuation"})]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-green-600 flex items-center",children:["Vested",e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx(q,{data:[{label:"Vested",value:s.vested_shares,color:"#10B981"},{label:"Unvested",value:s.remaining_unvested_shares,color:"#E5E7EB"}],size:40})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:P==="number"?s.vested_shares.toLocaleString():`SAR ${(s.vested_shares*Y).toLocaleString()}`}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s.total_shares>0?(s.vested_shares/s.total_shares*100).toFixed(2)+"%":"0%"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-yellow-600 flex items-center",children:["Unvested",e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx(q,{data:[{label:"Unvested",value:s.remaining_unvested_shares,color:"#F59E0B"},{label:"Vested",value:s.vested_shares,color:"#E5E7EB"}],size:40})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:P==="number"?s.remaining_unvested_shares.toLocaleString():`SAR ${(s.remaining_unvested_shares*Y).toLocaleString()}`}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s.total_shares>0?(s.remaining_unvested_shares/s.total_shares*100).toFixed(2)+"%":"0%"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-orange-600 flex items-center",children:["Lapsed",e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx(q,{data:[{label:"Lapsed",value:s.total_lapsed||0,color:"#F97316"},{label:"Active",value:s.total_shares-(s.total_lapsed||0),color:"#E5E7EB"}],size:40})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:P==="number"?(s.total_lapsed||0).toLocaleString():`SAR ${((s.total_lapsed||0)*Y).toLocaleString()}`}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s.total_shares>0?((s.total_lapsed||0)/s.total_shares*100).toFixed(2)+"%":"0%"})]}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-medium text-purple-600 flex items-center",children:["Exercised",e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-3 h-3 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx("div",{className:"text-lg font-bold text-purple-700",children:"0"})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-2",children:[e.jsxs("span",{className:"text-xs font-medium text-green-600 flex items-center",children:["Buy-Back",e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-3 h-3 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx("div",{className:"text-lg font-bold text-purple-700",children:"0"})]})]})})]})})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"When is my next vesting due?"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:s.grants.filter(t=>t.status==="active"&&t.incentive_plans).slice(0,2).map((t,r)=>e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${r===0?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:[t.incentive_plans.plan_name_en||"Grant"," - ",t.incentive_plans.plan_type||"ESOP"]},t.id))})]}),e.jsxs("div",{className:"p-6",children:[s.next_vesting_date&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.next_vesting_date.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[s.grants.filter(t=>t.status==="active"&&t.incentive_plans).reduce((t,r)=>{const i=Number(r.total_shares)-Number(r.vested_shares||0);return t+i},0)," Options"]})]}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:s.vested_shares.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-500",children:"options"}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Cumulative Vested Options"})]})]}),!s.next_vesting_date&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No upcoming vesting dates"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("div",{className:"text-4xl font-bold text-purple-700 mb-2",children:["SAR ",(s.vested_shares*Y).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Exercise Price Payable for Vested Qty."})]})]}),e.jsxs("div",{className:"lg:col-span-1 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Shares Roadmap"}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:s.roadmapData&&s.roadmapData.length>0?e.jsxs(e.Fragment,{children:["Total: ",s.roadmapData.reduce((t,r)=>t+(r.vestedShares||0)+(r.unvestedShares||0),0).toLocaleString()," shares"]}):"No data available"})]}),e.jsx("div",{className:"p-6",children:s.roadmapData&&s.roadmapData.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-end justify-between gap-2",style:{height:"256px"},children:s.roadmapData.map((t,r)=>{const i=Math.max(...s.roadmapData.map(m=>(m.unvestedValuation||0)+(m.vestedValuation||0)),1),d=(t.unvestedValuation||0)+(t.vestedValuation||0),o=i>0?d/i*256:0,x=d>0?(t.vestedValuation||0)/d*o:0,h=o-x,y=x>0?Math.max(x,4):0,c=h>0?Math.max(h,4):0;return e.jsxs("div",{className:"flex-1 h-full flex flex-col items-center group cursor-pointer relative",children:[e.jsxs("div",{className:"hidden group-hover:block absolute bottom-full mb-2 bg-gray-900 text-white text-xs rounded-lg px-3 py-2 shadow-lg z-10 whitespace-nowrap transform -translate-x-1/2 left-1/2",children:[e.jsx("div",{className:"font-semibold mb-1",children:t.year}),t.vestedValuation>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-green-300",children:["• Vested Valuation: ",e.jsxs("strong",{children:["SAR ",t.vestedValuation.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-green-300",children:["• Vested Shares: ",e.jsx("strong",{children:t.vestedShares.toLocaleString()})]})]}),t.unvestedValuation>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-purple-300",children:["• Unvested Valuation: ",e.jsxs("strong",{children:["SAR ",t.unvestedValuation.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-purple-300",children:["• Unvested Shares: ",e.jsx("strong",{children:t.unvestedShares.toLocaleString()})]})]}),d===0&&e.jsx("div",{className:"text-gray-400",children:"No shares in this period"})]}),e.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-end",children:[(t.unvestedShares>0||t.vestedShares>0)&&e.jsx("div",{className:"absolute text-xs font-semibold text-gray-700 whitespace-nowrap",style:{bottom:`${o+4}px`,left:"50%",transform:"translateX(-50%)"},children:(t.unvestedShares+t.vestedShares).toLocaleString()}),c>0&&e.jsx("div",{className:"w-full bg-gradient-to-t from-purple-600 to-purple-500 rounded-t-lg transition-all duration-300 group-hover:from-purple-700 group-hover:to-purple-600 group-hover:shadow-lg",style:{height:`${c}px`}}),y>0&&e.jsx("div",{className:"w-full bg-gradient-to-t from-green-600 to-green-500 transition-all duration-300 group-hover:from-green-700 group-hover:to-green-600 group-hover:shadow-lg",style:{height:`${y}px`,borderRadius:c===0?"0.5rem 0.5rem 0 0":"0"}})]})]},r)})}),e.jsx("div",{className:"flex items-center justify-between gap-2 mt-2 border-t border-gray-200 pt-3",children:s.roadmapData.map((t,r)=>e.jsx("div",{className:"flex-1 text-center",children:e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:t.year})},r))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-xs text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-600"}),e.jsx("span",{children:"Vested Shares (SAR)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-purple-600"}),e.jsx("span",{children:"Unvested Shares (SAR)"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Vested includes:"})," vested, transferred, exercised, due, and past-dated events"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Unvested includes:"})," pending and future-dated events"]})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ee,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No roadmap data available"})]})})]})]}),Q.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-yellow-800",children:"Action Required"})]}),e.jsx("p",{className:"text-yellow-700 mb-4",children:"You have grants that require your signature. Please review and accept the contracts to activate your equity grants."}),e.jsx("div",{className:"space-y-3",children:Q.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-yellow-300",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.grant_number}),e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Pending Signature"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Number(t.total_shares).toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-600",children:"shares"})]}),e.jsx("button",{onClick:()=>ue(t),className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition font-medium",children:"Review Contract"})]})]},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-8",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-blue-600"}),"Your Vesting Calendar"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Track upcoming vesting milestones and review past events."})]})}),O.length>0?e.jsx(De,{events:O,onEventClick:t=>{z(t),U(!0)}}):e.jsxs("div",{className:"py-12 text-center text-gray-500 border border-dashed border-gray-200 rounded-lg",children:[e.jsx(Ve,{className:"w-10 h-10 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No vesting events scheduled yet. Your future vesting milestones will appear here."})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-8",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Your Grants"}),s.grants.length>0?e.jsx("div",{className:"space-y-3",children:s.grants.map(t=>{var o,x;const i=(((x=(o=t.document_status)==null?void 0:o.toLowerCase)==null?void 0:x.call(o))||"")==="pending_signature",d=i?"bg-yellow-100 text-yellow-800":t.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-700",l=i?"Pending Signature":t.status==="active"?"Active":t.status||"Draft";return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.grant_number}),e.jsx("div",{className:"flex items-center space-x-3 text-sm text-gray-600 mt-1",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${d}`,children:l})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Number(t.total_shares).toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-600",children:"shares"})]})]},t.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Le,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Active Grants"}),e.jsx("p",{className:"text-gray-600",children:"You don't have any active equity grants at this time."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(we,{tadawulSymbol:ne,vestedShares:s.vested_shares,unvestedShares:s.remaining_unvested_shares}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Vested Shares"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.vested_shares.toLocaleString()})]}),e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Unvested Shares"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.remaining_unvested_shares.toLocaleString()})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-6 h-6 text-white"})})]})]})]})]}),e.jsx(Se,{currentPrice:85.5,vestedShares:s.vested_shares}),de&&C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Review Grant Agreement"}),e.jsx("button",{onClick:()=>B(!1),className:"text-gray-400 hover:text-gray-600 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 border border-gray-200",children:e.jsx("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap font-mono",children:oe})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium",children:"By accepting this agreement, you acknowledge:"}),e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:"• Understanding of the grant terms and vesting schedule"}),e.jsx("li",{children:"• Acceptance of company equity plan conditions"}),e.jsx("li",{children:"• Agreement to tax implications and restrictions"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsx("button",{onClick:ge,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium",children:"Accept Agreement"})]})]})]})]})}),xe&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Vesting Event Details"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(b.vesting_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsx("button",{onClick:()=>{U(!1),z(null)},className:"text-gray-400 hover:text-gray-600 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Plan"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:b.plan_name}),b.plan_code&&e.jsx("p",{className:"text-sm text-gray-500",children:b.plan_code})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Shares To Vest"}),e.jsxs("p",{className:"text-base font-semibold text-gray-900",children:[Math.floor(Number(b.shares_to_vest||0)).toLocaleString()," shares"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Status"}),e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium bg-blue-50 text-blue-700",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-blue-500"}),b.status.replace("_"," ")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Event Type"}),e.jsx("p",{className:"text-base font-semibold text-gray-900 capitalize",children:((X=b.event_type)==null?void 0:X.replace("_"," "))||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Grant"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((J=b.grants)==null?void 0:J.grant_number)||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Days Remaining"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.days_remaining})]}),b.performance_notes&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Performance Notes"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:b.performance_notes})]})]})]}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end",children:e.jsx("button",{onClick:()=>{U(!1),z(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Close"})})]})})]})}export{Fe as default};

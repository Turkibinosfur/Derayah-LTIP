import{a as k,u as F,s as h,j as e,r as v}from"./index-DDk1oefv.js";import{r as l}from"./react-vendor-xiFAdxLt.js";import{p as y,G,r as O,x as R,V as D}from"./ui-vendor-B0ZOy8uN.js";import"./supabase-vendor-B-LuImWU.js";function H(){const{t:r,i18n:N}=k(),{isSuperAdmin:x}=F(),[w,C]=l.useState([]),[_,p]=l.useState(!0),[o,S]=l.useState(""),[m,$]=l.useState("all"),[E,g]=l.useState(null),[i,c]=l.useState({en:"",ar:""}),[T,f]=l.useState(!1),[u,d]=l.useState(null),t=N.language==="ar";l.useEffect(()=>{x()&&b()},[x]);const b=async()=>{try{p(!0);const{data:s,error:a}=await h.from("translations").select("*").order("translation_key",{ascending:!0});if(a)throw a;C(s||[])}catch(s){console.error("Error loading translations:",s),d({type:"error",text:r("translations.error")})}finally{p(!1)}},n=w.reduce((s,a)=>(s[a.translation_key]||(s[a.translation_key]={en:"",ar:""}),s[a.translation_key][a.language_code]=a.translation_value,s),{}),L=Object.keys(n).filter(s=>{const a=s.toLowerCase().includes(o.toLowerCase())||n[s].en.toLowerCase().includes(o.toLowerCase())||n[s].ar.includes(o);return m==="all"?a:m==="en"?a&&n[s].en.toLowerCase().includes(o.toLowerCase()):a&&n[s].ar.includes(o)}),A=s=>{g(s),c({en:n[s].en||"",ar:n[s].ar||""})},K=()=>{g(null),c({en:"",ar:""})},V=async s=>{try{f(!0),d(null);const{error:a}=await h.from("translations").upsert({translation_key:s,language_code:"en",translation_value:i.en,namespace:"translation"},{onConflict:"translation_key,language_code,namespace"});if(a)throw a;const{error:j}=await h.from("translations").upsert({translation_key:s,language_code:"ar",translation_value:i.ar,namespace:"translation"},{onConflict:"translation_key,language_code,namespace"});if(j)throw j;await v("en"),await v("ar"),await b(),g(null),c({en:"",ar:""}),d({type:"success",text:r("translations.saved")}),setTimeout(()=>d(null),3e3)}catch(a){console.error("Error saving translation:",a),d({type:"error",text:r("translations.error")})}finally{f(!1)}};return x()?_?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`flex items-center justify-between ${t?"flex-row-reverse":""}`,children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r("translations.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:r("translations.description")})]}),e.jsx(G,{className:"w-8 h-8 text-blue-600"})]}),u&&e.jsxs("div",{className:`p-4 rounded-lg border flex items-center space-x-2 ${t?"space-x-reverse":""} ${u.type==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:[u.type==="success"?e.jsx(O,{className:"w-5 h-5"}):e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:u.text})]}),e.jsxs("div",{className:`bg-white rounded-xl border border-gray-200 p-6 ${t?"text-right":"text-left"}`,children:[e.jsxs("div",{className:`flex gap-4 mb-6 ${t?"flex-row-reverse":""}`,children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(R,{className:`absolute top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 ${t?"right-3":"left-3"}`}),e.jsx("input",{type:"text",placeholder:r("translations.search"),value:o,onChange:s=>S(s.target.value),className:`w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t?"text-right pr-10 pl-4":"text-left"}`})]}),e.jsxs("select",{value:m,onChange:s=>$(s.target.value),className:`px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${t?"text-right":"text-left"}`,children:[e.jsx("option",{value:"all",children:r("translations.all")}),e.jsx("option",{value:"en",children:r("translations.english")}),e.jsx("option",{value:"ar",children:r("translations.arabic")})]})]}),e.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:L.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:E===s?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("translations.english")}),e.jsx("input",{type:"text",value:i.en,onChange:a=>c({...i,en:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-left"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("translations.arabic")}),e.jsx("input",{type:"text",value:i.ar,onChange:a=>c({...i,ar:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-right",dir:"rtl"})]})]}),e.jsxs("div",{className:`flex gap-2 ${t?"flex-row-reverse":""}`,children:[e.jsxs("button",{onClick:()=>V(s),disabled:T,className:`flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed ${t?"space-x-reverse":""}`,children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:r("common.save")})]}),e.jsx("button",{onClick:K,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:r("common.cancel")})]})]}):e.jsxs("div",{className:`flex items-center justify-between ${t?"flex-row-reverse":""}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 mb-2",children:s}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[r("translations.english"),":"]}),e.jsx("div",{className:"text-gray-900 mt-1",children:n[s].en||"-"})]}),e.jsxs("div",{className:t?"text-right":"text-left",children:[e.jsxs("span",{className:"text-gray-500",children:[r("translations.arabic"),":"]}),e.jsx("div",{className:"text-gray-900 mt-1",dir:"rtl",children:n[s].ar||"-"})]})]})]}),e.jsx("button",{onClick:()=>A(s),className:`px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded-lg ${t?"mr-4":"ml-4"}`,children:r("common.edit")})]})},s))})]})]}):e.jsxs("div",{className:"bg-white rounded-xl p-12 border border-gray-200 text-center",children:[e.jsx(y,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"Only super administrators can access this page."})]})}export{H as default};

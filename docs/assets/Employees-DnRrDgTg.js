import{a as Re,b as Be,s as _,j as e}from"./index-CHcuUdej.js";import{r as y}from"./react-vendor-xiFAdxLt.js";import{f as q}from"./dateUtils-DoPl8O0G.js";import{w as Xe,x as Ge,y as He,z as ze,U as We,E as Oe,H as O,J as ne,K as Ye,N as Je,R as oe}from"./ui-vendor-a8g5-7pO.js";import"./supabase-vendor-B-LuImWU.js";function at(){var _e,je,ve;const{t:b,i18n:Ne}=Re(),f=Ne.language==="ar",{brandColor:m,getBgColor:Ke}=Be(),[X,we]=y.useState([]),[ke,Ce]=y.useState(!0),[U,Ee]=y.useState(""),[Y,$e]=y.useState("all"),[ie,V]=y.useState(null),[r,A]=y.useState(null),[Se,G]=y.useState(!1),[Pe,J]=y.useState(!1),[Me,K]=y.useState(!1),[H,Q]=y.useState("details"),[R,ce]=y.useState([]),[d,de]=y.useState(null),[u,Te]=y.useState(null),[Ie,me]=y.useState(!1),[ue,Z]=y.useState(!1),[xe,F]=y.useState(!1),[ee,Ae]=y.useState(null),te=y.useRef(null),[pe,he]=y.useState(null),[se,ae]=y.useState(null),[I,re]=y.useState(!1),[a,p]=y.useState({national_id:"",first_name_en:"",last_name_en:"",email:"",phone:"",department:"",job_title:"",employment_status:"active",hire_date:"",portal_username:"",portal_password:"",portal_access_enabled:!1}),[l,S]=y.useState({first_name_en:"",last_name_en:"",email:"",phone:"",department:"",job_title:"",employment_status:"active",hire_date:"",portal_username:"",portal_password:"",portal_access_enabled:!1}),[j,T]=y.useState({iban:"",bank_name:"",bank_branch_code:"",account_holder_name_ar:"",investment_account_number:"",broker_custodian_name:"",broker_account_number:"",tadawul_investor_number:""});y.useEffect(()=>{B()},[]),y.useEffect(()=>{const t=s=>{te.current&&!te.current.contains(s.target)&&V(null)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const B=async()=>{try{const{data:{user:t}}=await _.auth.getUser();if(!t)return;const{data:s}=await _.from("company_users").select("company_id").eq("user_id",t.id).maybeSingle();if(s){const{data:n,error:o}=await _.from("employees").select("*").eq("company_id",s.company_id).order("created_at",{ascending:!1});if(o)throw o;if(n){const{data:g}=await _.from("grants").select("employee_id, total_shares, vested_shares, remaining_unvested_shares, status").eq("company_id",s.company_id).in("status",["active","pending_signature"]),i=(g||[]).reduce((x,v)=>{x[v.employee_id]||(x[v.employee_id]={total_shares:0,vested_shares:0,unvested_shares:0}),x[v.employee_id].total_shares+=Number(v.total_shares)||0,x[v.employee_id].vested_shares+=Number(v.vested_shares)||0;const c=(Number(v.total_shares)||0)-(Number(v.vested_shares)||0);return x[v.employee_id].unvested_shares+=c,x},{}),h=n.map(x=>{const v=i[x.id]||{total_shares:0,vested_shares:0,unvested_shares:0},c=v.total_shares>0?v.vested_shares/v.total_shares*100:0;return{...x,...v,vesting_progress:c}});we(h)}}}catch(t){console.error("Error loading employees:",t)}finally{Ce(!1)}},z=X.filter(t=>{const s=t.first_name_en.toLowerCase().includes(U.toLowerCase())||t.last_name_en.toLowerCase().includes(U.toLowerCase())||t.email.toLowerCase().includes(U.toLowerCase())||t.employee_number.toLowerCase().includes(U.toLowerCase()),n=Y==="all"||t.employment_status===Y;return s&&n}),ge=async t=>{A(t),G(!0),V(null),Q("details"),await W(t.id)},W=async t=>{me(!0);try{const{data:{user:s}}=await _.auth.getUser();if(!s)return;const{data:n}=await _.from("company_users").select("company_id").eq("user_id",s.id).maybeSingle();if(!n)return;const{data:o,error:g}=await _.from("grants").select(`
          *,
          incentive_plans:plan_id (
            plan_name_en,
            plan_type,
            exercise_price
          )
        `).eq("employee_id",t).order("grant_date",{ascending:!1});if(g)throw g;if(o){const x=o.filter(k=>k.status==="active"||k.status==="pending_signature"),v=await Promise.all(x.map(async k=>{const{data:w}=await _.from("vesting_events").select("*").eq("grant_id",k.id).order("sequence_number",{ascending:!0});let D=Number(k.vested_shares)||0;return w&&w.length>0&&(D=w.filter(N=>N.status==="vested"||N.status==="transferred"||N.status==="exercised").reduce((N,$)=>N+Number($.shares_to_vest||0),0)),{...k,computed_vested_shares:D,total_transferred:(w==null?void 0:w.filter(N=>N.status==="transferred").reduce((N,$)=>N+Number($.shares_to_vest||0),0))||0,total_exercised:(w==null?void 0:w.filter(N=>N.status==="exercised").reduce((N,$)=>N+Number($.shares_to_vest||0),0))||0}}));ce(v);const c=x.reduce((k,w)=>k+(Number(w.total_shares)||0),0),C=v.reduce((k,w)=>k+(w.computed_vested_shares||0),0),L=c-C,P=x.reduce((k,w)=>{var $;const D=Number(w.total_shares)||0,N=Number(($=w.incentive_plans)==null?void 0:$.exercise_price)||0;return k+D*N},0),{data:E}=await _.from("companies").select("total_shares_authorized").eq("id",n.company_id).maybeSingle(),M=E!=null&&E.total_shares_authorized?c/Number(E.total_shares_authorized)*100:0;de({total_shares:c,vested_shares:C,unvested_shares:L,ownership_percentage:M,market_value:P})}const{data:i,error:h}=await _.from("employee_financial_info").select("*").eq("employee_id",t).maybeSingle();h?console.error("Error loading financial info:",h):(Te(i),i&&T({iban:i.iban||"",bank_name:i.bank_name||"",bank_branch_code:i.bank_branch_code||"",account_holder_name_ar:i.account_holder_name_ar||"",investment_account_number:i.investment_account_number||"",broker_custodian_name:i.broker_custodian_name||"",broker_account_number:i.broker_account_number||"",tadawul_investor_number:i.tadawul_investor_number||""}))}catch(s){console.error("Error loading employee financials:",s)}finally{me(!1)}},Le=t=>{A(t),p({national_id:t.national_id||"",first_name_en:t.first_name_en,last_name_en:t.last_name_en,email:t.email,phone:t.phone||"",department:t.department||"",job_title:t.job_title||"",employment_status:t.employment_status,hire_date:t.hire_date||"",portal_username:t.portal_username||"",portal_password:t.portal_password||"",portal_access_enabled:t.portal_access_enabled||!1}),J(!0),V(null)},le=(t,s)=>{if(!t||!s||t.trim()===""||s.trim()===""){const C=["password","employee","portal","access","secure","user","login","account"],L=C[Math.floor(Math.random()*C.length)],P=Math.floor(Math.random()*9e3)+1e3,E=["!","@","#","$"],M=E[Math.floor(Math.random()*E.length)];return`${L}${P}${M}`}const n=t.charAt(0).toUpperCase(),o=s.charAt(0).toUpperCase(),g=t.substring(0,Math.min(3,t.length)).toLowerCase(),i=s.substring(0,Math.min(2,s.length)).toLowerCase(),h=Math.floor(Math.random()*900)+100,x=["!","@","#","$","%"],v=x[Math.floor(Math.random()*x.length)];return`${n}${o}${g}${i}${h}${v}`},Fe=()=>{S({first_name_en:"",last_name_en:"",email:"",phone:"",department:"",job_title:"",employment_status:"active",hire_date:"",portal_username:"",portal_password:"",portal_access_enabled:!1}),K(!0)},De=async()=>{try{const{data:t,error:s}=await _.from("companies").select("id").eq("company_name_en","Derayah Financial").maybeSingle();if(s||!t){alert("Company not found. Please contact your administrator.");return}const n=X.length,o=`EMP-${new Date().getFullYear()}-${String(n+1).padStart(3,"0")}`,{data:g,error:i}=await _.from("employees").insert({company_id:t.id,employee_number:o,national_id:`ID${Date.now()}`,first_name_en:l.first_name_en,last_name_en:l.last_name_en,email:l.email,phone:l.phone||null,department:l.department||null,job_title:l.job_title||null,employment_status:l.employment_status,hire_date:l.hire_date||null,portal_username:l.portal_username||null,portal_password:l.portal_password||null,portal_access_enabled:l.portal_access_enabled}).select().single();if(i){console.error("Error creating employee:",i),alert(`Failed to create employee: ${i.message}`);return}if(l.portal_access_enabled&&l.portal_username&&l.portal_password){console.log("Creating auth user for new employee...");try{const{data:h,error:x}=await _.rpc("create_employee_auth_user_auto",{p_employee_id:g.id,p_email:l.email,p_portal_username:l.portal_username,p_portal_password:l.portal_password});x?(console.error("Error creating auth user:",x),alert(`Employee created but portal access setup failed: ${x.message}`)):h&&h.success?(console.log("Portal access enabled:",h),h.requires_manual_auth_creation?alert(`Employee created successfully! Portal access enabled.

To complete the setup, please:
1. Go to Supabase Dashboard > Authentication > Users
2. Click "Add user"
3. Email: ${l.email}
4. Password: ${l.portal_password}
5. Set Email Confirm to true
6. Click "Create user"

After creating the auth user, the employee can log in immediately!`):alert(`Employee created successfully! Portal access enabled. They can now log in using their email: ${l.email}`)):(console.error("Portal access setup failed:",h),alert("Employee created but portal access setup failed. Please enable portal access manually."))}catch(h){console.error("Error in auth user creation:",h),alert("Employee created but portal access setup failed. Please enable portal access manually.")}}else alert("Employee created successfully!");await B(),K(!1)}catch(t){console.error("Error creating employee:",t),alert("Failed to create employee. Please try again.")}},be=async()=>{if(r)try{const t={national_id:a.national_id||null,first_name_en:a.first_name_en,last_name_en:a.last_name_en,email:a.email,phone:a.phone||null,department:a.department||null,job_title:a.job_title||null,employment_status:a.employment_status,hire_date:a.hire_date||null,portal_username:a.portal_username||null,portal_password:a.portal_password||null,portal_access_enabled:a.portal_access_enabled};if(console.log("Updating employee with data:",t),console.log("Employee ID:",r.id),a.portal_access_enabled&&a.portal_username&&a.portal_password){console.log("Creating auth user for employee portal access...");try{const{data:n,error:o}=await _.rpc("create_employee_auth_user_auto",{p_employee_id:r.id,p_email:a.email,p_portal_username:a.portal_username,p_portal_password:a.portal_password});o?(console.error("Error creating auth user:",o),alert(`Employee updated but portal access setup failed: ${o.message}`)):n&&n.success?(console.log("Portal access enabled:",n),n.requires_manual_auth_creation?alert(`Employee updated successfully! Portal access enabled.

To complete the setup, please:
1. Go to Supabase Dashboard > Authentication > Users
2. Click "Add user"
3. Email: ${a.email}
4. Password: ${a.portal_password}
5. Set Email Confirm to true
6. Click "Create user"

After creating the auth user, the employee can log in immediately!`):alert(`Employee updated successfully! Portal access enabled. They can now log in using their email: ${a.email}`)):(console.error("Portal access setup failed:",n),alert("Employee updated but portal access setup failed. Please enable portal access manually."))}catch(n){console.error("Error in auth user creation:",n),alert("Employee updated but portal access setup failed. Please enable portal access manually.")}}const{error:s}=await _.from("employees").update(t).eq("id",r.id);if(s)throw s;alert("Employee updated successfully!"),xe||(J(!1),A(null),B())}catch(t){console.error("Error updating employee:",t),console.error("Error details:",t),t&&typeof t=="object"&&"message"in t?alert(`Failed to update employee: ${t.message}`):alert("Failed to update employee. Please check the console for details.")}},Ue=async t=>{if(confirm(`Are you sure you want to delete ${t.first_name_en} ${t.last_name_en}?`))try{const{error:s}=await _.from("employees").delete().eq("id",t.id);if(s)throw s;B()}catch(s){console.error("Error deleting employee:",s),alert("Failed to delete employee")}V(null)},Ve=async()=>{var t,s;if(r)try{const{data:{user:n}}=await _.auth.getUser();if(!n)return;const{data:o}=await _.from("company_users").select("company_id, id").eq("user_id",n.id).maybeSingle();if(!o)return;const g={employee_id:r.id,company_id:o.company_id,iban:j.iban||null,bank_name:j.bank_name||null,bank_branch_code:j.bank_branch_code||null,account_holder_name_ar:j.account_holder_name_ar||null,investment_account_number:j.investment_account_number||null,broker_custodian_name:j.broker_custodian_name||null,broker_account_number:j.broker_account_number||null,tadawul_investor_number:j.tadawul_investor_number||null,created_by:o.id};if(u){const{error:i}=await _.from("employee_financial_info").update(g).eq("employee_id",r.id);if(i)if(i.code==="PGRST116"||(t=i.message)!=null&&t.includes("duplicate")){const{error:h}=await _.from("employee_financial_info").upsert(g,{onConflict:"employee_id",ignoreDuplicates:!1});if(h)throw h}else throw i;alert("Financial information updated successfully!")}else{const{error:i}=await _.from("employee_financial_info").insert(g);if(i)if(i.code==="23505"||(s=i.message)!=null&&s.includes("duplicate key")){const{error:h}=await _.from("employee_financial_info").update(g).eq("employee_id",r.id);if(h)throw h;alert("Financial information updated successfully!")}else throw i;else alert("Financial information saved successfully!")}await W(r.id),Z(!1)}catch(n){console.error("Error saving financial info:",n);const o=(n==null?void 0:n.message)||"Unknown error occurred";alert(`Failed to save financial information: ${o}. Please try again.`)}},fe=async t=>{if(!(!r||!u))try{const{data:{user:s}}=await _.auth.getUser();if(!s)return;const{data:n}=await _.from("company_users").select("id, role").eq("user_id",s.id).maybeSingle();if(!n||!["super_admin","finance_admin","company_admin"].includes(n.role)){alert("Only finance admins and company admins can verify financial information.");return}const{error:o}=await _.from("employee_financial_info").update({account_status:t,verified_by:n.id,verified_at:new Date().toISOString(),account_verification_date:new Date().toISOString().split("T")[0]}).eq("employee_id",r.id);if(o)throw o;alert(`Financial information ${t==="verified"?"verified":"rejected"} successfully!`),await W(r.id)}catch(s){console.error("Error verifying financial info:",s),alert("Failed to verify financial information. Please try again.")}},qe=async t=>{if(!t.portal_username||!t.portal_password){alert("Employee must have portal credentials set before sending. Please edit the employee first.");return}if(window.confirm(`Send portal credentials to ${t.first_name_en} ${t.last_name_en} at ${t.email}?`))try{alert(`Portal credentials sent to ${t.email}!

Username: ${t.portal_username}
Password: ${t.portal_password}`),V(null)}catch(s){console.error("Error sending credentials:",s),alert("Failed to send credentials")}},ye={active:"bg-green-100 text-green-800",terminated:"bg-red-100 text-red-800",resigned:"bg-yellow-100 text-yellow-800",retired:"bg-gray-100 text-gray-800"};return ke?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:`space-y-6 ${f?"text-right":"text-left"}`,dir:f?"rtl":"ltr",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:f?"text-right":"",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:b("employees.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:b("employees.description")})]}),e.jsxs("div",{className:`flex items-center space-x-3 ${f?"space-x-reverse":""}`,children:[e.jsxs("button",{className:`flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition ${f?"space-x-reverse":""}`,children:[e.jsx(Xe,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:b("employees.importCSV")})]}),e.jsxs("button",{onClick:Fe,className:`flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition ${f?"space-x-reverse":""}`,style:{backgroundColor:m},onMouseEnter:t=>{const s=parseInt(m.slice(1,3),16)*.9,n=parseInt(m.slice(3,5),16)*.9,o=parseInt(m.slice(5,7),16)*.9;t.currentTarget.style.backgroundColor=`rgb(${Math.round(s)}, ${Math.round(n)}, ${Math.round(o)})`},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=m},children:[e.jsx(Ge,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:b("employees.addEmployee")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:`flex items-center space-x-4 ${f?"space-x-reverse flex-row-reverse":""}`,children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(He,{className:`absolute ${f?"right-3":"left-3"} top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400`}),e.jsx("input",{type:"text",placeholder:b("employees.searchPlaceholder"),value:U,onChange:t=>Ee(t.target.value),className:`w-full ${f?"pr-10 pl-4 text-right":"pl-10 pr-4 text-left"} py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{className:`flex items-center space-x-2 ${f?"space-x-reverse":""}`,children:[e.jsx(ze,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:Y,onChange:t=>$e(t.target.value),className:`px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f?"text-right":"text-left"}`,children:[e.jsx("option",{value:"all",children:b("employees.allStatus")}),e.jsx("option",{value:"active",children:b("employees.active")}),e.jsx("option",{value:"terminated",children:b("employees.terminated")}),e.jsx("option",{value:"resigned",children:b("employees.resigned")}),e.jsx("option",{value:"retired",children:b("employees.retired")})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",style:{minWidth:"1200px"},children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0 z-20",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider sticky ${f?"right-0":"left-0"} z-30 bg-gray-50`,children:b("employees.employee")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.employeeNumber")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.department")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.totalShares")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.vested")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.unvested")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.vestingProgress")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-right":"text-left"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.status")}),e.jsx("th",{className:`px-6 py-3 ${f?"text-left":"text-right"} text-xs font-medium text-gray-500 uppercase tracking-wider`,children:b("employees.actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:9,className:"px-6 py-12 text-center",children:[e.jsx(We,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium",children:b("employees.noEmployeesFound")}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:b("employees.noEmployeesDesc")})]})}):z.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition group",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap sticky left-0 z-20 bg-white group-hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-medium text-sm",children:[t.first_name_en.charAt(0),t.last_name_en.charAt(0)]})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("button",{onClick:()=>ge(t),className:"text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline transition text-left",children:[t.first_name_en," ",t.last_name_en]}),e.jsx("p",{className:"text-xs text-gray-500",children:t.job_title||"N/A"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:t.employee_number})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:t.department||"Unassigned"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.total_shares?t.total_shares.toLocaleString():"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-green-600",children:t.vested_shares?t.vested_shares.toLocaleString():"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:t.unvested_shares?t.unvested_shares.toLocaleString():"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"w-32",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:[t.vesting_progress?t.vesting_progress.toFixed(0):"0","%"]})}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all",style:{backgroundColor:m,width:`${t.vesting_progress||0}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${ye[t.employment_status]}`,children:t.employment_status})}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap ${f?"text-left":"text-right"}`,children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:s=>{const o=s.currentTarget.getBoundingClientRect(),g=180,i=window.innerHeight-o.bottom,h=o.top;let x;i>=g+10?x=o.bottom+8:h>=g+10?x=o.top-g+5:x=window.innerHeight-g-10,Ae({top:x,left:o.right-192}),V(ie===t.id?null:t.id)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition",children:e.jsx(Oe,{className:"w-4 h-4"})}),ie===t.id&&ee&&e.jsxs("div",{ref:te,className:"fixed w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-[9999]",style:{top:`${ee.top}px`,left:`${ee.left}px`},children:[e.jsxs("button",{onClick:()=>ge(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-gray-700 hover:bg-gray-50 rounded-t-lg transition`,children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:b("employees.view")})]}),e.jsxs("button",{onClick:()=>Le(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-gray-700 hover:bg-gray-50 transition`,children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{children:b("employees.edit")})]}),e.jsxs("button",{onClick:()=>qe(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-blue-600 hover:bg-blue-50 transition`,children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{children:b("employees.sendCredentials")})]}),e.jsxs("button",{onClick:()=>Ue(t),className:`flex items-center space-x-2 w-full px-4 py-2 ${f?"text-right space-x-reverse":"text-left"} text-sm text-red-600 hover:bg-red-50 rounded-b-lg transition`,children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{children:b("employees.delete")})]})]})]})})]},t.id))})]})}),z.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",z.length," of ",X.length," employees"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-200 rounded transition",children:"Previous"}),e.jsx("button",{className:"px-3 py-1 text-sm text-white rounded",style:{backgroundColor:m},children:"1"}),e.jsx("button",{className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-200 rounded transition",children:"2"}),e.jsx("button",{className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-200 rounded transition",children:"Next"})]})]})})]}),Se&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t=>{t.target===t.currentTarget&&(G(!1),F(!1),A(null))},children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[r.first_name_en," ",r.last_name_en]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Employee #",r.employee_number]})]}),e.jsx("button",{onClick:()=>{G(!1),F(!1),A(null)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition","aria-label":"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex space-x-8 px-6",children:[e.jsx("button",{onClick:()=>Q("details"),className:`py-4 border-b-2 font-medium text-sm transition ${H==="details"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Employee Details"}),e.jsx("button",{onClick:()=>Q("financial"),className:`py-4 border-b-2 font-medium text-sm transition ${H==="financial"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Financial Overview"})]})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[H==="details"&&e.jsxs("div",{className:"space-y-6",children:[xe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee Number"}),e.jsx("p",{className:"text-gray-900 font-mono",children:r.employee_number}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cannot be changed"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["National/Iqama ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.national_id||"",onChange:t=>p({...a,national_id:t.target.value}),placeholder:"Enter National/Iqama ID",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.first_name_en,onChange:t=>p({...a,first_name_en:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.last_name_en,onChange:t=>p({...a,last_name_en:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:a.email,onChange:t=>p({...a,email:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"text",value:a.phone,onChange:t=>p({...a,phone:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",value:a.department,onChange:t=>p({...a,department:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title"}),e.jsx("input",{type:"text",value:a.job_title,onChange:t=>p({...a,job_title:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Status"}),e.jsxs("select",{value:a.employment_status,onChange:t=>p({...a,employment_status:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"resigned",children:"Resigned"}),e.jsx("option",{value:"retired",children:"Retired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hire Date"}),e.jsx("input",{type:"date",value:a.hire_date,onChange:t=>p({...a,hire_date:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"portal_access_enabled",checked:a.portal_access_enabled,onChange:t=>p({...a,portal_access_enabled:t.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"portal_access_enabled",className:"text-sm font-medium text-gray-700",children:"Enable Portal Access"})]}),a.portal_access_enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Portal Username"}),e.jsx("input",{type:"text",value:a.portal_username,onChange:t=>p({...a,portal_username:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Portal Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:I?"text":"password",value:a.portal_password,onChange:t=>p({...a,portal_password:t.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{type:"button",onClick:()=>re(!I),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",title:I?"Hide password":"Show password",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("button",{type:"button",onClick:()=>{const t=le(a.first_name_en,a.last_name_en);p({...a,portal_password:t})},className:"mt-2 w-full px-3 py-2 text-white rounded-lg transition flex items-center justify-center gap-2",style:{backgroundColor:m},onMouseEnter:t=>{const s=parseInt(m.slice(1,3),16)*.9,n=parseInt(m.slice(3,5),16)*.9,o=parseInt(m.slice(5,7),16)*.9;t.currentTarget.style.backgroundColor=`rgb(${Math.round(s)}, ${Math.round(n)}, ${Math.round(o)})`},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=m},title:"Generate password based on employee name",children:[e.jsx(oe,{className:"w-4 h-4"}),"Generate Password"]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2 pt-4 border-t border-gray-200",children:[e.jsxs("button",{onClick:()=>{F(!0),p({national_id:r.national_id||"",first_name_en:r.first_name_en,last_name_en:r.last_name_en,email:r.email,phone:r.phone||"",department:r.department||"",job_title:r.job_title||"",employment_status:r.employment_status,hire_date:r.hire_date||"",portal_username:r.portal_username||"",portal_password:r.portal_password||"",portal_access_enabled:r.portal_access_enabled||!1})},className:"px-4 py-2 text-sm bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{F(!1),p({national_id:r.national_id||"",first_name_en:r.first_name_en,last_name_en:r.last_name_en,email:r.email,phone:r.phone||"",department:r.department||"",job_title:r.job_title||"",employment_status:r.employment_status,hire_date:r.hire_date||"",portal_username:r.portal_username||"",portal_password:r.portal_password||"",portal_access_enabled:r.portal_access_enabled||!1})},className:"px-4 py-2 text-sm bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:"Cancel"}),e.jsx("button",{onClick:async()=>{await be(),F(!1),await B();const t=X.find(s=>s.id===r.id);t&&(A(t),await W(t.id))},className:"px-4 py-2 text-sm text-white rounded-lg transition",style:{backgroundColor:m},onMouseEnter:t=>{const s=parseInt(m.slice(1,3),16)*.9,n=parseInt(m.slice(3,5),16)*.9,o=parseInt(m.slice(5,7),16)*.9;t.currentTarget.style.backgroundColor=`rgb(${Math.round(s)}, ${Math.round(n)}, ${Math.round(o)})`},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=m},children:"Save Changes"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Employee Number"}),e.jsx("p",{className:"text-gray-900",children:r.employee_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"National/Iqama ID"}),e.jsx("p",{className:"text-gray-900 font-mono",children:r.national_id?`ID: ${String(r.national_id).padStart(9,"0")}`:"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Employment Status"}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${ye[r.employment_status]}`,children:r.employment_status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Hire Date"}),e.jsx("p",{className:"text-gray-900",children:r.hire_date?q(r.hire_date):"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"First Name"}),e.jsx("p",{className:"text-gray-900",children:r.first_name_en})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Last Name"}),e.jsx("p",{className:"text-gray-900",children:r.last_name_en})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:r.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Phone"}),e.jsx("p",{className:"text-gray-900",children:r.phone||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Department"}),e.jsx("p",{className:"text-gray-900",children:r.department||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Job Title"}),e.jsx("p",{className:"text-gray-900",children:r.job_title||"N/A"})]})]}),e.jsx("div",{className:"flex justify-start pt-4 border-t border-gray-200",children:e.jsxs("button",{onClick:()=>{F(!0),p({national_id:r.national_id||"",first_name_en:r.first_name_en,last_name_en:r.last_name_en,email:r.email,phone:r.phone||"",department:r.department||"",job_title:r.job_title||"",employment_status:r.employment_status,hire_date:r.hire_date||"",portal_username:r.portal_username||"",portal_password:r.portal_password||"",portal_access_enabled:r.portal_access_enabled||!1})},className:"px-4 py-2 text-sm bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Edit"]})})]}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Banking & Investment Accounts"}),e.jsxs("div",{className:"flex gap-2",children:[(u==null?void 0:u.account_status)==="verified"&&e.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"✓ Verified"}),(u==null?void 0:u.account_status)==="pending"&&e.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"⏳ Pending"}),(u==null?void 0:u.account_status)==="rejected"&&e.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:"✗ Rejected"}),ue?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Ve,className:"px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"Save"}),e.jsx("button",{onClick:()=>{Z(!1),u&&T({iban:u.iban||"",bank_name:u.bank_name||"",bank_branch_code:u.bank_branch_code||"",account_holder_name_ar:u.account_holder_name_ar||"",investment_account_number:u.investment_account_number||"",broker_custodian_name:u.broker_custodian_name||"",broker_account_number:u.broker_account_number||"",tadawul_investor_number:u.tadawul_investor_number||""})},className:"px-4 py-2 text-sm bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:"Cancel"})]}):e.jsx("button",{onClick:()=>Z(!0),className:"px-4 py-2 text-sm text-white rounded-lg transition",style:{backgroundColor:m},onMouseEnter:t=>{const s=parseInt(m.slice(1,3),16)*.9,n=parseInt(m.slice(3,5),16)*.9,o=parseInt(m.slice(5,7),16)*.9;t.currentTarget.style.backgroundColor=`rgb(${Math.round(s)}, ${Math.round(n)}, ${Math.round(o)})`},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=m},children:u?"Edit":"Add Financial Info"})]})]}),ue?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Banking Information (for Cash Transfers)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["IBAN ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:j.iban,onChange:t=>T({...j,iban:t.target.value}),placeholder:"SAXX XXXX XXXX XXXX XXXX XXXX",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",value:j.bank_name,onChange:t=>T({...j,bank_name:t.target.value}),placeholder:"e.g., Al Rajhi Bank",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Code"}),e.jsx("input",{type:"text",value:j.bank_branch_code,onChange:t=>T({...j,bank_branch_code:t.target.value}),placeholder:"Branch code",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Holder Name (Arabic)"}),e.jsx("input",{type:"text",value:j.account_holder_name_ar,onChange:t=>T({...j,account_holder_name_ar:t.target.value}),placeholder:"الاسم بالعربية",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",dir:"rtl"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Investment Account Information (for Share Transfers)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Investment Account Number (Nostro)"}),e.jsx("input",{type:"text",value:j.investment_account_number,onChange:t=>T({...j,investment_account_number:t.target.value}),placeholder:"Custody account number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Broker/Custodian Name"}),e.jsx("input",{type:"text",value:j.broker_custodian_name,onChange:t=>T({...j,broker_custodian_name:t.target.value}),placeholder:"e.g., NCB Capital, Al Rajhi Capital",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Broker Account Number"}),e.jsx("input",{type:"text",value:j.broker_account_number,onChange:t=>T({...j,broker_account_number:t.target.value}),placeholder:"Broker account number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tadawul Investor Number"}),e.jsx("input",{type:"text",value:j.tadawul_investor_number,onChange:t=>T({...j,tadawul_investor_number:t.target.value}),placeholder:"Tadawul investor number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})]}):e.jsx("div",{className:"space-y-6",children:u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Banking Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"IBAN"}),e.jsx("p",{className:"text-gray-900",children:u.iban||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Bank Name"}),e.jsx("p",{className:"text-gray-900",children:u.bank_name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Branch Code"}),e.jsx("p",{className:"text-gray-900",children:u.bank_branch_code||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Account Holder (Arabic)"}),e.jsx("p",{className:"text-gray-900",dir:"rtl",children:u.account_holder_name_ar||"Not provided"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Investment Account Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Investment Account Number"}),e.jsx("p",{className:"text-gray-900 font-mono text-sm",children:u.investment_account_number?"••••••••":"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Broker/Custodian"}),e.jsx("p",{className:"text-gray-900",children:u.broker_custodian_name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Broker Account Number"}),e.jsx("p",{className:"text-gray-900 font-mono text-sm",children:u.broker_account_number?"••••••••":"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Tadawul Investor Number"}),e.jsx("p",{className:"text-gray-900",children:u.tadawul_investor_number||"Not provided"})]})]})]}),u.account_verification_date&&e.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Verified on ",q(u.account_verification_date)]})}),u.account_status==="pending"&&e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>fe("verified"),className:"px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"✓ Verify Account"}),e.jsx("button",{onClick:()=>fe("rejected"),className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"✗ Reject"})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:'No financial information available. Click "Add Financial Info" to add banking and investment account details.'})})})]})})]}),H==="financial"&&e.jsx("div",{className:"space-y-6",children:Ie?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-gray-500",children:"Loading financial data..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6 border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Financial Overview"}),e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Granted Shares"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((_e=d==null?void 0:d.total_shares)==null?void 0:_e.toLocaleString())||"0"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Vested Shares"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:((je=d==null?void 0:d.vested_shares)==null?void 0:je.toLocaleString())||"0"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Unvested Shares"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:((ve=d==null?void 0:d.unvested_shares)==null?void 0:ve.toLocaleString())||"0"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Value"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:d!=null&&d.market_value?`${d.market_value.toLocaleString()} SAR`:"N/A"})]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"transform -rotate-90 w-32 h-32",children:[e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"#e5e7eb",strokeWidth:"16",fill:"none"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"#10b981",strokeWidth:"16",fill:"none",strokeDasharray:`${((d==null?void 0:d.vested_shares)||0)/((d==null?void 0:d.total_shares)||1)*351.86} 351.86`,strokeLinecap:"round"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"#3b82f6",strokeWidth:"16",fill:"none",strokeDasharray:`${((d==null?void 0:d.unvested_shares)||0)/((d==null?void 0:d.total_shares)||1)*351.86} 351.86`,strokeDashoffset:`-${((d==null?void 0:d.vested_shares)||0)/((d==null?void 0:d.total_shares)||1)*351.86}`,strokeLinecap:"round"})]}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Vesting"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:(d==null?void 0:d.total_shares)>0?`${(((d==null?void 0:d.vested_shares)||0)/d.total_shares*100).toFixed(0)}%`:"0%"})]})]}),e.jsxs("div",{className:"mt-3 space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-gray-600",children:"Vested"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-gray-600",children:"Unvested"})]})]})]})]})]}),R.length>0&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 bg-gradient-to-b from-gray-50 to-white",children:[e.jsx("div",{className:"mb-4 flex justify-between items-center",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Grant Timeline"})}),e.jsx("div",{className:"space-y-4",children:(()=>{const t=R.filter(c=>c.vesting_start_date&&c.vesting_end_date&&(c.status==="active"||c.status==="pending_signature"));if(t.length===0)return null;const s=t.flatMap(c=>[new Date(c.vesting_start_date),new Date(c.vesting_end_date)]),n=new Date(Math.min(...s.map(c=>c.getTime()))),o=new Date(Math.max(...s.map(c=>c.getTime()))),g=n,i=o,h=i.getTime()-g.getTime(),x=c=>(new Date(c).getTime()-g.getTime())/h*100,v=()=>{const c=[],C=g.getFullYear(),L=i.getFullYear();for(let P=C;P<=L;P++){let E=0;const M=new Date(P,0,1);M>=g&&M<=i?E=x(M.toISOString().split("T")[0]):P===C?E=-5:P===L?E=100:E=(P-C)/(L-C)*100,c.push({year:P,position:E})}return c};return e.jsxs(e.Fragment,{children:[t.map(c=>{var D;const C=x(c.vesting_start_date),P=x(c.vesting_end_date)-C,E=c.computed_vested_shares||Number(c.vested_shares)||0,M=Number(c.total_shares)||0,k=M>0?E/M*100:0,w=((D=c.incentive_plans)==null?void 0:D.plan_name_en)||"Unknown Plan";return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-40 text-sm font-medium text-gray-700 truncate",title:w,children:w}),e.jsxs("div",{className:"text-xs text-gray-500 ml-2 mr-4",children:[M.toLocaleString(),"/",E.toLocaleString()," shares"]}),e.jsx("div",{className:"relative h-8 flex-1 cursor-pointer",onMouseEnter:N=>{he(c.id);const $=N.currentTarget.getBoundingClientRect();ae({x:$.left+$.width/2,y:$.top-10})},onMouseMove:N=>{const $=N.currentTarget.getBoundingClientRect();ae({x:N.clientX,y:$.top-10})},onMouseLeave:()=>{he(null),ae(null)},children:e.jsxs("div",{className:"absolute inset-y-0 left-0 flex rounded-lg overflow-hidden",style:{width:`${P}%`,left:`${C}%`},children:[k>0&&e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-300 h-full flex items-center justify-center",style:{width:`${k}%`},children:e.jsx("span",{className:"text-xs font-semibold text-white px-2 truncate",children:k>=15?`${Math.floor(k)}%`:""})}),e.jsx("div",{className:"bg-gradient-to-r from-gray-200 to-gray-100 h-full flex items-center justify-center",style:{width:`${100-k}%`},children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Future"})})]})})]})},c.id)}),e.jsxs("div",{className:"flex items-center mt-4",children:[e.jsx("div",{className:"w-40"}),e.jsx("div",{className:"ml-2 mr-4",children:e.jsx("div",{className:"w-20"})}),e.jsx("div",{className:"relative h-6 flex-1 border-t-2 border-gray-300",children:e.jsx("div",{className:"absolute inset-x-0 -top-4",children:v().map((c,C)=>e.jsx("div",{className:"absolute text-xs text-gray-600 font-medium",style:{left:`${c.position}%`,transform:"translateX(-50%)"},children:c.year},C))})})]})]})})()}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-blue-400"}),e.jsx("span",{className:"text-gray-700",children:"Vested"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-200"}),e.jsx("span",{className:"text-gray-700",children:"Unvested"})]})]})]}),pe&&se&&(()=>{var v;const t=R.find(c=>c.id===pe);if(!t)return null;const s=t.computed_vested_shares||Number(t.vested_shares)||0,n=Number(t.total_shares)||0,o=n-s,g=n>0?s/n*100:0,i=((v=t.incentive_plans)==null?void 0:v.plan_name_en)||"Unknown Plan",h=t.total_transferred||0,x=t.total_exercised||0;return e.jsxs("div",{className:"fixed z-50 bg-gray-900 text-white text-sm rounded-lg px-4 py-3 shadow-xl pointer-events-none whitespace-nowrap",style:{left:`${se.x}px`,top:`${se.y}px`,transform:"translate(-50%, -100%)"},children:[e.jsx("div",{className:"font-semibold text-base mb-2",children:i}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Total Shares:"}),e.jsx("span",{className:"font-medium",children:n.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Vested:"}),e.jsxs("span",{className:"font-medium text-green-400",children:[s.toLocaleString()," (",g.toFixed(1),"%)"]})]}),h>0&&e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Transferred:"}),e.jsx("span",{className:"font-medium text-purple-400",children:h.toLocaleString()})]}),x>0&&e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Exercised:"}),e.jsx("span",{className:"font-medium text-orange-400",children:x.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Unvested:"}),e.jsxs("span",{className:"font-medium text-blue-400",children:[o.toLocaleString()," (",(100-g).toFixed(1),"%)"]})]}),e.jsx("div",{className:"border-t border-gray-700 pt-1 mt-1",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-gray-300",children:"Period:"}),e.jsxs("span",{className:"font-medium",children:[q(t.vesting_start_date)," - ",q(t.vesting_end_date)]})]})})]})]})})(),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Active Grants"}),R.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No grants found for this employee"}):e.jsx("div",{className:"space-y-3",children:R.map(t=>{var s;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:((s=t.incentive_plans)==null?void 0:s.plan_name_en)||"Unknown Plan"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Grant Date: ",q(t.grant_date)]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.status==="active"?"bg-green-100 text-green-800":t.status==="vested"?"bg-blue-100 text-blue-800":t.status==="expired"?"bg-red-100 text-red-800":(t.status==="cancelled","bg-gray-100 text-gray-800")}`,children:t.status})]}),(()=>{var o,g,i,h;const n=t.computed_vested_shares||Number(t.vested_shares)||0;return e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Total Shares"}),e.jsx("p",{className:"font-semibold text-gray-900",children:(o=Number(t.total_shares))==null?void 0:o.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Vested Shares"}),e.jsx("p",{className:"font-semibold text-gray-900",children:n.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Exercise Price"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[(i=Number((g=t.incentive_plans)==null?void 0:g.exercise_price))==null?void 0:i.toLocaleString()," SAR"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Total Value"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[(n*(Number((h=t.incentive_plans)==null?void 0:h.exercise_price)||0)).toLocaleString()," SAR"]})]})]})})(),t.vesting_end_date&&t.total_shares&&(()=>{const o=(t.computed_vested_shares||Number(t.vested_shares)||0)/Number(t.total_shares)*100;return e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Vesting Progress"}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[o.toFixed(1),"%"]})]}),e.jsx("div",{className:"mt-2 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-blue-600 h-full transition-all",style:{width:`${o}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Vesting ends: ",q(t.vesting_end_date)]})]})})()]},t.id)})})]})]})})]}),e.jsx("div",{className:"flex-shrink-0 p-6 border-t border-gray-200 bg-white flex items-center justify-end",children:e.jsx("button",{onClick:()=>{G(!1),F(!1),A(null),ce([]),de(null)},className:"px-6 py-2 text-white rounded-lg transition",style:{backgroundColor:m},onMouseEnter:t=>{const s=parseInt(m.slice(1,3),16)*.9,n=parseInt(m.slice(3,5),16)*.9,o=parseInt(m.slice(5,7),16)*.9;t.currentTarget.style.backgroundColor=`rgb(${Math.round(s)}, ${Math.round(n)}, ${Math.round(o)})`},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=m},children:"Close"})})]})}),Pe&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Employee"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["National/Iqama ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.national_id||"",onChange:t=>p({...a,national_id:t.target.value}),placeholder:"Enter National/Iqama ID",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee Number"}),e.jsx("p",{className:"px-4 py-2 text-gray-600 bg-gray-50 rounded-lg border border-gray-200",children:r.employee_number}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cannot be changed"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:a.first_name_en,onChange:t=>p({...a,first_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:a.last_name_en,onChange:t=>p({...a,last_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:a.email,onChange:t=>p({...a,email:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:a.phone,onChange:t=>p({...a,phone:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:a.department,onChange:t=>p({...a,department:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Title"}),e.jsx("input",{type:"text",value:a.job_title,onChange:t=>p({...a,job_title:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Status"}),e.jsxs("select",{value:a.employment_status,onChange:t=>p({...a,employment_status:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"resigned",children:"Resigned"}),e.jsx("option",{value:"retired",children:"Retired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hire Date"}),e.jsx("input",{type:"date",value:a.hire_date,onChange:t=>p({...a,hire_date:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Employee Portal Credentials"}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"portal_access_enabled",checked:a.portal_access_enabled,onChange:t=>p({...a,portal_access_enabled:t.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"portal_access_enabled",className:"text-sm font-medium text-gray-700",children:"Enable Employee Portal Access"})]}),a.portal_access_enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Username"}),e.jsx("input",{type:"text",value:a.portal_username,onChange:t=>p({...a,portal_username:t.target.value}),placeholder:"Enter username for employee portal",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:I?"text":"password",value:a.portal_password,onChange:t=>p({...a,portal_password:t.target.value}),placeholder:"Enter password for employee portal",className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{type:"button",onClick:()=>re(!I),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",title:I?"Hide password":"Show password",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("button",{type:"button",onClick:()=>{const t=le(a.first_name_en,a.last_name_en);p({...a,portal_password:t})},className:"mt-2 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2",title:"Generate password based on employee name",children:[e.jsx(oe,{className:"w-4 h-4"}),"Generate Password"]})]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 p-6 border-t border-gray-200 bg-white flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{J(!1),A(null)},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsx("button",{onClick:be,className:"px-6 py-2 text-white rounded-lg transition",style:{backgroundColor:m},onMouseEnter:t=>{const s=parseInt(m.slice(1,3),16)*.9,n=parseInt(m.slice(3,5),16)*.9,o=parseInt(m.slice(5,7),16)*.9;t.currentTarget.style.backgroundColor=`rgb(${Math.round(s)}, ${Math.round(n)}, ${Math.round(o)})`},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=m},children:"Save Changes"})]})]})}),Me&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Employee"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:l.first_name_en,onChange:t=>S({...l,first_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:l.last_name_en,onChange:t=>S({...l,last_name_en:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:l.email,onChange:t=>{const s=t.target.value;s!=="superadmin@derayah.com"&&S({...l,email:s,portal_username:l.portal_access_enabled?s:l.portal_username})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"employee@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:l.phone,onChange:t=>S({...l,phone:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",value:l.department,onChange:t=>S({...l,department:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Title"}),e.jsx("input",{type:"text",value:l.job_title,onChange:t=>S({...l,job_title:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Status"}),e.jsxs("select",{value:l.employment_status,onChange:t=>S({...l,employment_status:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"resigned",children:"Resigned"}),e.jsx("option",{value:"retired",children:"Retired"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hire Date"}),e.jsx("input",{type:"date",value:l.hire_date,onChange:t=>S({...l,hire_date:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Employee Portal Access"}),e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("input",{type:"checkbox",id:"portal_access_enabled",checked:l.portal_access_enabled,onChange:t=>{const s=t.target.checked;if(s&&!l.email){alert("Please add employee email first before enabling portal access.");return}if(s&&l.email==="superadmin@derayah.com"){alert("Cannot use superadmin@derayah.com as employee email.");return}S({...l,portal_access_enabled:s,portal_username:s&&l.email?l.email:l.portal_username})},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"portal_access_enabled",className:"text-sm font-medium text-gray-700",children:"Enable Employee Portal Access"})]}),l.portal_access_enabled&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Username"}),e.jsx("input",{type:"text",value:l.portal_username&&l.portal_username!=="superadmin@derayah.com"?l.portal_username:l.email||"",onChange:t=>{const s=t.target.value;s!=="superadmin@derayah.com"&&S({...l,portal_username:s})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:l.email||"employee@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Portal Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:I?"text":"password",value:l.portal_password,onChange:t=>S({...l,portal_password:t.target.value}),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter password for portal access"}),e.jsx("button",{type:"button",onClick:()=>re(!I),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",title:I?"Hide password":"Show password",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("button",{type:"button",onClick:()=>{const t=le(l.first_name_en,l.last_name_en);S({...l,portal_password:t})},className:"mt-2 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2",title:"Generate password based on employee name",children:[e.jsx(oe,{className:"w-4 h-4"}),"Generate Password"]})]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 p-6 border-t border-gray-200 bg-white flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:()=>K(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsx("button",{onClick:De,className:"px-6 py-2 text-white rounded-lg transition",style:{backgroundColor:m},onMouseEnter:t=>{const s=parseInt(m.slice(1,3),16)*.9,n=parseInt(m.slice(3,5),16)*.9,o=parseInt(m.slice(5,7),16)*.9;t.currentTarget.style.backgroundColor=`rgb(${Math.round(s)}, ${Math.round(n)}, ${Math.round(o)})`},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=m},children:"Create Employee"})]})]})})]})}export{at as default};

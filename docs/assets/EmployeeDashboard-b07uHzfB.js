import{a as Se,s as C,j as e}from"./index-CHcuUdej.js";import{r as f}from"./react-vendor-xiFAdxLt.js";import{P as Ee}from"./PortfolioValuation-DO40RP8Y.js";import{P as Le}from"./PerformanceChart-hVdx1R8I.js";import{V as Me}from"./VestingEventsCalendar-BmRKjrzq.js";import{C as se,c as Ve,b as z,a as Ce,U as ke}from"./ui-vendor-a8g5-7pO.js";import"./supabase-vendor-B-LuImWU.js";function Ye(){var K,Z;const{t:s,i18n:te}=Se();te.language;const[ae,re]=f.useState(null),[ne,le]=f.useState(!0),[oe,de]=f.useState(""),[B,ie]=f.useState(30),[ce,Y]=f.useState(!1),[k,I]=f.useState(null),[me,xe]=f.useState(""),[T,O]=f.useState("number"),[W,he]=f.useState([]),[y,H]=f.useState(null),[ge,U]=f.useState(!1);f.useEffect(()=>{X()},[]);const pe=async t=>{try{const n=await fetch(`https://dataportal.saudiexchange.sa/wps/portal/tadawul/markets/equities/main-board/${t}`,{mode:"no-cors"});return console.log("Fetching Tadawul price for:",t),30}catch(n){return console.error("Error fetching Tadawul price:",n),30}},X=async()=>{var t,n,d;try{const{data:{user:i}}=await C.auth.getUser();if(!i){console.log("No authenticated user, redirecting to login..."),window.location.href="/employee/login";return}const{data:o,error:c}=await C.from("employees").select("id, company_id, first_name_en, last_name_en, email, user_id").eq("user_id",i.id).maybeSingle();if(c||!o){console.error("Error loading employee data:",c),window.location.href="/employee/login";return}console.log("Loading data for employee:",o);const[h,g,j]=await Promise.all([C.from("grants").select(`
            id, 
            total_shares, 
            vested_shares, 
            remaining_unvested_shares, 
            status, 
            grant_number, 
            grant_date,
            vesting_start_date,
            vesting_end_date,
            employee_acceptance_at,
            generated_documents (
              id,
              status,
              document_type,
              approved_at,
              approved_by
            ),
            incentive_plans(plan_name_en, plan_type)
          `).eq("employee_id",o.id),C.from("companies").select("tadawul_symbol, current_fmv, fmv_source").eq("id",o.company_id).maybeSingle(),C.from("vesting_events").select(`
            id,
            grant_id,
            employee_id,
            vesting_date,
            shares_to_vest,
            status,
            event_type,
            sequence_number,
            performance_condition_met,
            performance_notes,
            processed_at,
            processed_by,
            grants (
              id,
              grant_number,
              incentive_plans (
                plan_name_en,
                plan_code,
                plan_type
              )
            )
          `).eq("employee_id",o.id).order("vesting_date",{ascending:!0})]);let m=0,x=0,p=0,S=0,E=null,v=[];const M=h.data||[],$=j.data||[];j.error&&console.error("Error loading vesting events:",j.error);const ve=[o.first_name_en,o.last_name_en].filter(Boolean).join(" ").trim()||o.email,ye=$.map(u=>{var V,G,A;const b=(V=u.grants)==null?void 0:V.incentive_plans,_=new Date(u.vesting_date),w=new Date,L=_.getTime()-w.setHours(0,0,0,0),R=Math.max(0,Math.ceil(L/(1e3*60*60*24)));return{...u,employee_name:ve,plan_name:(b==null?void 0:b.plan_name_en)||((G=u.grants)==null?void 0:G.grant_number)||"Grant",plan_code:(b==null?void 0:b.plan_code)||((A=u.grants)==null?void 0:A.grant_number)||"",plan_type:(b==null?void 0:b.plan_type)||"ESOP",days_remaining:R,can_exercise:u.status==="due"||u.status==="pending",requires_exercise:!1}});if(M.length>0){m=M.reduce((r,l)=>r+Number(l.total_shares),0);const u=M.reduce((r,l)=>r+Number(l.vested_shares||0),0),b=$.reduce((r,l)=>{var D;const N=(D=l.status)==null?void 0:D.toLowerCase();return N==="due"||N==="transferred"||N==="exercised"?r+Number(l.shares_to_vest||0):r},0);x=u+b,p=m-x,S=M.filter(r=>r.status==="lapsed").reduce((r,l)=>r+Number(l.total_shares||0),0);const _=M.filter(r=>r.status==="active"&&r.vesting_end_date);_.length>0&&(E=_.map(l=>new Date(l.vesting_end_date)).filter(l=>l>new Date).sort((l,N)=>l.getTime()-N.getTime())[0]||null);const w=((t=g.data)==null?void 0:t.current_fmv)!==null&&((n=g.data)==null?void 0:n.current_fmv)!==void 0?Number(g.data.current_fmv):null;let L=30;if((d=g.data)!=null&&d.tadawul_symbol){const r=await pe(g.data.tadawul_symbol);typeof r=="number"&&!Number.isNaN(r)?L=r:w!==null&&!Number.isNaN(w)&&(L=w)}else w!==null&&!Number.isNaN(w)&&(L=w);ie(L);const R=new Date().getFullYear(),V=L,G=M.filter(r=>r.status==="active"),A=G.reduce((r,l)=>{const N=Number(l.total_shares||0),D=Number(l.vested_shares||0);return r+(N-D)},0),Q=new Date;Q.setHours(0,0,0,0);const P=new Set;$.forEach(r=>{const N=new Date(r.vesting_date).getFullYear();P.add(N)});const fe=P.size>0?Math.min(...Array.from(P)):R,_e=P.size>0?Math.max(...Array.from(P)):R,Ne=Math.min(R,fe),we=Math.max(R+4,_e);v=[];for(let r=Ne;r<=we;r++)v.push({year:String(r),unvestedShares:0,unvestedValuation:0,vestedShares:0,vestedValuation:0});if($.forEach(r=>{const l=new Date(r.vesting_date),N=l.getFullYear(),D=Number(r.shares_to_vest||0);if(D<=0)return;const De=N,F=v.findIndex(ee=>parseInt(ee.year)===De);F>=0&&(l<Q||r.status==="vested"||r.status==="transferred"||r.status==="exercised"||r.status==="due"?(v[F].vestedShares+=D,v[F].vestedValuation+=D*V):r.status!=="lapsed"&&(v[F].unvestedShares+=D,v[F].unvestedValuation+=D*V))}),v.reduce((r,l)=>r+l.unvestedShares+l.vestedShares,0)===0&&A>0){const r=A/5;v=v.map(l=>({...l,unvestedShares:Math.floor(r),unvestedValuation:Math.floor(r*V)}))}console.log("Grant Data:",{total_shares:m,vested_shares:x,remaining_unvested_shares:p,totalUnvestedShares:A,allActiveGrants:G.length,roadmapData:v,fmvPerShare:V,vestingEventsCount:$.length,roadmapTotalShares:v.reduce((r,l)=>r+l.unvestedShares+l.vestedShares,0)})}const je=M.map(u=>{const b=Array.isArray(u.generated_documents)?u.generated_documents:[],_=b.find(L=>L.document_type==="grant_agreement")||b[0],w=(_==null?void 0:_.status)||u.status||"draft";return{...u,document_status:w,contract_document_id:(_==null?void 0:_.id)||null}});g.data&&de(g.data.tadawul_symbol),re({grants:je,total_shares:m,vested_shares:x,remaining_unvested_shares:p,total_lapsed:S,next_vesting_date:E,roadmapData:v}),he(ye)}catch(i){console.error("Error loading employee data:",i)}finally{le(!1)}},ue=t=>{I(t);const n=sessionStorage.getItem("employee"),d=n?JSON.parse(n):{},i=`
EMPLOYEE STOCK GRANT AGREEMENT

Grant Number: ${t.grant_number}
Employee: ${d.first_name_en} ${d.last_name_en}
Email: ${d.email}
Date: ${new Date().toLocaleDateString()}

GRANT TERMS:
- Total Shares: ${Number(t.total_shares).toLocaleString()}
- Grant Date: ${new Date().toLocaleDateString()}
- Vesting Schedule: 4 years with 1-year cliff
- Vesting Start Date: ${new Date().toLocaleDateString()}
- Vesting End Date: ${new Date(Date.now()+4*365*24*60*60*1e3).toLocaleDateString()}

VESTING SCHEDULE:
- 25% vests after 1 year (cliff)
- Remaining 75% vests monthly over 3 years

CONDITIONS:
1. Employment must continue for shares to vest
2. Shares subject to company's equity plan
3. Tax implications apply per local regulations
4. Shares may be subject to transfer restrictions

ACCEPTANCE:
By signing below, the employee acknowledges receipt and understanding of this grant agreement.

Employee Signature: _________________ Date: _________

Company Representative: _________________ Date: _________

This agreement is subject to the terms and conditions of the company's equity incentive plan.
    `.trim();xe(i),Y(!0)},be=async()=>{if(k)try{const t=new Date(k.grant_date||new Date),n=new Date,d=Number(k.total_shares)||0,i=Math.max(0,(n.getFullYear()-t.getFullYear())*12+(n.getMonth()-t.getMonth()));let o=0;if(i>=12){const j=Math.floor(d*.25),x=(d-j)/36,p=Math.min(i-12,36);o=j+x*p}o=Math.min(o,d);const c=d-o,{error:h}=await C.from("grants").update({status:"active",employee_acceptance_at:new Date().toISOString(),vested_shares:Math.floor(o),remaining_unvested_shares:Math.floor(c)}).eq("id",k.id);if(h){console.error("Error accepting contract:",h),alert(s("employeeDashboard.failedToAcceptContract"));return}const{error:g}=await C.from("generated_documents").update({status:"signed"}).eq("grant_id",k.id);g&&console.error("Error updating document status:",g),Y(!1),I(null),await X(),alert(`Contract accepted successfully! Your grant is now active.

Vested shares: ${Math.floor(o).toLocaleString()}
Remaining unvested: ${Math.floor(c).toLocaleString()}`)}catch(t){console.error("Error accepting contract:",t),alert(s("employeeDashboard.failedToAcceptContract"))}};if(ne)return e.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"calc(100vh - 200px)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:s("employeeDashboard.loadingDashboard")})]})});const a=ae||{grants:[],total_shares:0,vested_shares:0,remaining_unvested_shares:0,total_lapsed:0,next_vesting_date:null,roadmapData:[]},J=a.grants.filter(t=>{var d,i,o,c;return t.employee_acceptance_at?!1:(((i=(d=t.document_status)==null?void 0:d.toLowerCase)==null?void 0:i.call(d))||((c=(o=t.status)==null?void 0:o.toLowerCase)==null?void 0:c.call(o))||"")==="pending_signature"});console.log("Display Grant Data Roadmap:",a.roadmapData);const q=({data:t,size:n=60})=>{const d=t.reduce((m,x)=>m+x.value,0);if(d===0)return e.jsx("div",{className:`w-${n/4} h-${n/4} rounded-full bg-gray-200`});let i=0;const o=n/2-2,c=n/2,h=n/2,g=(m,x)=>{const p=j(c,h,o,x),S=j(c,h,o,m),E=x-m<=180?"0":"1";return`M ${c} ${h} L ${p.x} ${p.y} A ${o} ${o} 0 ${E} 0 ${S.x} ${S.y} Z`},j=(m,x,p,S)=>{const E=(S-90)*Math.PI/180;return{x:m+p*Math.cos(E),y:x+p*Math.sin(E)}};return e.jsx("svg",{width:n,height:n,className:"transform -rotate-90",children:t.map((m,x)=>{const p=m.value/d*100,S=i*3.6,E=(i+p)*3.6;return i+=p,e.jsx("path",{d:g(S,E),fill:m.color,stroke:"white",strokeWidth:"1"},x)})})};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s("employeeDashboard.title")}),e.jsx("p",{className:"text-gray-600 mt-2",children:s("employeeDashboard.description")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl shadow-lg p-6 text-white",children:[e.jsx("p",{className:"text-blue-100 mb-2",children:s("employeeDashboard.totalSharesGranted")}),e.jsx("p",{className:"text-4xl font-bold",children:a.total_shares.toLocaleString()}),e.jsxs("p",{className:"text-blue-200 text-sm mt-2",children:[a.grants.length," ",a.grants.length===1?s("employeeDashboard.grant"):s("employeeDashboard.grants")]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-600 to-green-700 rounded-xl shadow-lg p-6 text-white",children:[e.jsx("p",{className:"text-green-100 mb-2",children:s("employeeDashboard.vestedShares")}),e.jsx("p",{className:"text-4xl font-bold",children:a.vested_shares.toLocaleString()}),e.jsxs("p",{className:"text-green-200 text-sm mt-2",children:[a.total_shares>0?(a.vested_shares/a.total_shares*100).toFixed(1):"0","% ",s("employeeDashboard.ofTotal")]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 rounded-xl shadow-lg p-6 text-white",children:[e.jsx("p",{className:"text-purple-100 mb-2",children:s("employeeDashboard.unvestedShares")}),e.jsx("p",{className:"text-4xl font-bold",children:a.remaining_unvested_shares.toLocaleString()}),e.jsxs("p",{className:"text-purple-200 text-sm mt-2",children:[a.total_shares>0?(a.remaining_unvested_shares/a.total_shares*100).toFixed(1):"0","% ",s("employeeDashboard.remaining")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s("employeeDashboard.status")}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4",children:[e.jsx("button",{onClick:()=>O("number"),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${T==="number"?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:s("employeeDashboard.number")}),e.jsx("button",{onClick:()=>O("valuation"),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${T==="valuation"?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:s("employeeDashboard.valuation")})]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-green-600 flex items-center",children:[s("employeeDashboard.vested"),e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx(q,{data:[{label:s("employeeDashboard.vested"),value:a.vested_shares,color:"#10B981"},{label:s("employeeDashboard.unvested"),value:a.remaining_unvested_shares,color:"#E5E7EB"}],size:40})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:T==="number"?a.vested_shares.toLocaleString():`SAR ${(a.vested_shares*B).toLocaleString()}`}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.total_shares>0?(a.vested_shares/a.total_shares*100).toFixed(2)+"%":"0%"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-yellow-600 flex items-center",children:[s("employeeDashboard.unvested"),e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx(q,{data:[{label:s("employeeDashboard.unvested"),value:a.remaining_unvested_shares,color:"#F59E0B"},{label:s("employeeDashboard.vested"),value:a.vested_shares,color:"#E5E7EB"}],size:40})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:T==="number"?a.remaining_unvested_shares.toLocaleString():`SAR ${(a.remaining_unvested_shares*B).toLocaleString()}`}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.total_shares>0?(a.remaining_unvested_shares/a.total_shares*100).toFixed(2)+"%":"0%"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-orange-600 flex items-center",children:[s("employeeDashboard.lapsed"),e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx(q,{data:[{label:s("employeeDashboard.lapsed"),value:a.total_lapsed||0,color:"#F97316"},{label:s("employeeDashboard.active"),value:a.total_shares-(a.total_lapsed||0),color:"#E5E7EB"}],size:40})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:T==="number"?(a.total_lapsed||0).toLocaleString():`SAR ${((a.total_lapsed||0)*B).toLocaleString()}`}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.total_shares>0?((a.total_lapsed||0)/a.total_shares*100).toFixed(2)+"%":"0%"})]}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-medium text-purple-600 flex items-center",children:[s("employeeDashboard.exercised"),e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-3 h-3 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx("div",{className:"text-lg font-bold text-purple-700",children:"0"})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-2",children:[e.jsxs("span",{className:"text-xs font-medium text-green-600 flex items-center",children:[s("employeeDashboard.buyBack"),e.jsx("span",{className:"ml-1",children:"›"}),e.jsx("svg",{className:"w-3 h-3 ml-1 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),e.jsx("div",{className:"text-lg font-bold text-purple-700",children:"0"})]})]})})]})})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s("employeeDashboard.whenIsNextVesting")}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:a.grants.filter(t=>t.status==="active"&&t.incentive_plans).slice(0,2).map((t,n)=>e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${n===0?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:[t.incentive_plans.plan_name_en||"Grant"," - ",t.incentive_plans.plan_type||"ESOP"]},t.id))})]}),e.jsxs("div",{className:"p-6",children:[a.next_vesting_date&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:a.next_vesting_date.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[a.grants.filter(t=>t.status==="active"&&t.incentive_plans).reduce((t,n)=>{const d=Number(n.total_shares)-Number(n.vested_shares||0);return t+d},0)," ",s("employeeDashboard.options")]})]}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:a.vested_shares.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-500",children:s("employeeDashboard.options")}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:s("employeeDashboard.cumulativeVestedOptions")})]})]}),!a.next_vesting_date&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(se,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:s("employeeDashboard.noUpcomingVestingDates")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("div",{className:"text-4xl font-bold text-purple-700 mb-2",children:["SAR ",(a.vested_shares*B).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-500",children:s("employeeDashboard.exercisePricePayable")})]})]}),e.jsxs("div",{className:"lg:col-span-1 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s("employeeDashboard.sharesRoadmap")}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:a.roadmapData&&a.roadmapData.length>0?e.jsxs(e.Fragment,{children:[s("employeeDashboard.total"),": ",a.roadmapData.reduce((t,n)=>t+(n.vestedShares||0)+(n.unvestedShares||0),0).toLocaleString()," ",s("employeeDashboard.shares")]}):s("employeeDashboard.noDataAvailable")})]}),e.jsx("div",{className:"p-6",children:a.roadmapData&&a.roadmapData.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-end justify-between gap-2",style:{height:"256px"},children:a.roadmapData.map((t,n)=>{const d=Math.max(...a.roadmapData.map(x=>(x.unvestedValuation||0)+(x.vestedValuation||0)),1),i=(t.unvestedValuation||0)+(t.vestedValuation||0),c=d>0?i/d*256:0,h=i>0?(t.vestedValuation||0)/i*c:0,g=c-h,j=h>0?Math.max(h,4):0,m=g>0?Math.max(g,4):0;return e.jsxs("div",{className:"flex-1 h-full flex flex-col items-center group cursor-pointer relative",children:[e.jsxs("div",{className:"hidden group-hover:block absolute bottom-full mb-2 bg-gray-900 text-white text-xs rounded-lg px-3 py-2 shadow-lg z-10 whitespace-nowrap transform -translate-x-1/2 left-1/2",children:[e.jsx("div",{className:"font-semibold mb-1",children:t.year}),t.vestedValuation>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-green-300",children:["• Vested Valuation: ",e.jsxs("strong",{children:["SAR ",t.vestedValuation.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-green-300",children:["• Vested Shares: ",e.jsx("strong",{children:t.vestedShares.toLocaleString()})]})]}),t.unvestedValuation>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-purple-300",children:["• Unvested Valuation: ",e.jsxs("strong",{children:["SAR ",t.unvestedValuation.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-purple-300",children:["• Unvested Shares: ",e.jsx("strong",{children:t.unvestedShares.toLocaleString()})]})]}),i===0&&e.jsx("div",{className:"text-gray-400",children:s("employeeDashboard.noDataAvailable")})]}),e.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-end",children:[(t.unvestedShares>0||t.vestedShares>0)&&e.jsx("div",{className:"absolute text-xs font-semibold text-gray-700 whitespace-nowrap",style:{bottom:`${c+4}px`,left:"50%",transform:"translateX(-50%)"},children:(t.unvestedShares+t.vestedShares).toLocaleString()}),m>0&&e.jsx("div",{className:"w-full bg-gradient-to-t from-purple-600 to-purple-500 rounded-t-lg transition-all duration-300 group-hover:from-purple-700 group-hover:to-purple-600 group-hover:shadow-lg",style:{height:`${m}px`}}),j>0&&e.jsx("div",{className:"w-full bg-gradient-to-t from-green-600 to-green-500 transition-all duration-300 group-hover:from-green-700 group-hover:to-green-600 group-hover:shadow-lg",style:{height:`${j}px`,borderRadius:m===0?"0.5rem 0.5rem 0 0":"0"}})]})]},n)})}),e.jsx("div",{className:"flex items-center justify-between gap-2 mt-2 border-t border-gray-200 pt-3",children:a.roadmapData.map((t,n)=>e.jsx("div",{className:"flex-1 text-center",children:e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:t.year})},n))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-xs text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-600"}),e.jsx("span",{children:s("employeeDashboard.vestedSharesSAR")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-purple-600"}),e.jsx("span",{children:s("employeeDashboard.unvestedSharesSAR")})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:s("employeeDashboard.vestedIncludes")})}),e.jsx("p",{children:e.jsx("strong",{children:s("employeeDashboard.unvestedIncludes")})})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ve,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-sm",children:s("employeeDashboard.noRoadmapDataAvailable")})]})})]})]}),J.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-yellow-800",children:s("employeeDashboard.actionRequired")})]}),e.jsx("p",{className:"text-yellow-700 mb-4",children:s("employeeDashboard.actionRequiredMessage")}),e.jsx("div",{className:"space-y-3",children:J.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-yellow-300",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.grant_number}),e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:s("employeeDashboard.pendingSignature")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Number(t.total_shares).toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-600",children:s("employeeDashboard.shares")})]}),e.jsx("button",{onClick:()=>ue(t),className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition font-medium",children:s("employeeDashboard.reviewContract")})]})]},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-8",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-blue-600"}),s("employeeDashboard.yourVestingCalendar")]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s("employeeDashboard.trackUpcomingVesting")})]})}),W.length>0?e.jsx(Me,{events:W,onEventClick:t=>{H(t),U(!0)}}):e.jsxs("div",{className:"py-12 text-center text-gray-500 border border-dashed border-gray-200 rounded-lg",children:[e.jsx(Ce,{className:"w-10 h-10 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-sm",children:s("employeeDashboard.noVestingEventsScheduled")})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6 mb-8",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:s("employeeDashboard.yourGrants")}),a.grants.length>0?e.jsx("div",{className:"space-y-3",children:a.grants.map(t=>{var c,h;const d=(((h=(c=t.document_status)==null?void 0:c.toLowerCase)==null?void 0:h.call(c))||"")==="pending_signature",i=d?"bg-yellow-100 text-yellow-800":t.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-700",o=d?s("employeeDashboard.pendingSignature"):t.status==="active"?"Active":t.status||s("employeeDashboard.draft");return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.grant_number}),e.jsx("div",{className:"flex items-center space-x-3 text-sm text-gray-600 mt-1",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${i}`,children:o})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Number(t.total_shares).toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-600",children:s("employeeDashboard.shares")})]})]},t.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ke,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:s("employeeDashboard.noActiveGrants")}),e.jsx("p",{className:"text-gray-600",children:s("employeeDashboard.noActiveGrantsMessage")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(Ee,{tadawulSymbol:oe,vestedShares:a.vested_shares,unvestedShares:a.remaining_unvested_shares}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:s("employeeDashboard.quickStats")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s("employeeDashboard.vestedSharesLabel")}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.vested_shares.toLocaleString()})]}),e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s("employeeDashboard.unvestedSharesLabel")}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a.remaining_unvested_shares.toLocaleString()})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-white"})})]})]})]})]}),e.jsx(Le,{currentPrice:85.5,vestedShares:a.vested_shares}),ce&&k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s("employeeDashboard.reviewGrantAgreement")}),e.jsx("button",{onClick:()=>Y(!1),className:"text-gray-400 hover:text-gray-600 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 border border-gray-200",children:e.jsx("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap font-mono",children:me})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium",children:s("employeeDashboard.byAcceptingAgreement")}),e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsxs("li",{children:["• ",s("employeeDashboard.understandingGrantTerms")]}),e.jsxs("li",{children:["• ",s("employeeDashboard.acceptanceOfConditions")]}),e.jsxs("li",{children:["• ",s("employeeDashboard.agreementToTaxImplications")]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>Y(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:s("common.cancel")}),e.jsx("button",{onClick:be,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium",children:s("employeeDashboard.acceptAgreement")})]})]})]})]})}),ge&&y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s("employeeDashboard.vestingEventDetails")}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(y.vesting_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsx("button",{onClick:()=>{U(!1),H(null)},className:"text-gray-400 hover:text-gray-600 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:s("employeeDashboard.plan")}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:y.plan_name}),y.plan_code&&e.jsx("p",{className:"text-sm text-gray-500",children:y.plan_code})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:s("employeeDashboard.sharesToVest")}),e.jsxs("p",{className:"text-base font-semibold text-gray-900",children:[Math.floor(Number(y.shares_to_vest||0)).toLocaleString()," ",s("employeeDashboard.shares")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Status"}),e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium bg-blue-50 text-blue-700",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-blue-500"}),y.status.replace("_"," ")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:s("employeeDashboard.eventType")}),e.jsx("p",{className:"text-base font-semibold text-gray-900 capitalize",children:((K=y.event_type)==null?void 0:K.replace("_"," "))||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:s("employeeDashboard.grant")}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((Z=y.grants)==null?void 0:Z.grant_number)||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:s("employeeDashboard.daysRemaining")}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:y.days_remaining})]}),y.performance_notes&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:s("employeeDashboard.performanceNotes")}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:y.performance_notes})]})]})]}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end",children:e.jsx("button",{onClick:()=>{U(!1),H(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:s("employeeDashboard.close")})})]})})]})}export{Ye as default};

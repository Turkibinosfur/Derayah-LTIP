import{s as o,j as e}from"./index-DDk1oefv.js";import{r as a}from"./react-vendor-xiFAdxLt.js";import{i as v,r as _,k as w,C as S,F as k,D as C,p as u,V as $}from"./ui-vendor-B0ZOy8uN.js";import"./supabase-vendor-B-LuImWU.js";function P(){const[s,i]=a.useState({employee_id:"",email_notifications:!0,vesting_reminders:!0,document_alerts:!0,price_alerts:!1,tax_reminders:!0,price_alert_threshold:0,reminder_days_before:7}),[b,h]=a.useState(!0),[d,m]=a.useState(!1),[g,c]=a.useState(!1),[x,p]=a.useState(null);a.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:{user:r}}=await o.auth.getUser();if(!r)return;const{data:t}=await o.from("employees").select("id").eq("user_id",r.id).maybeSingle();if(t){p(t.id);const{data:n,error:E}=await o.from("employee_notification_preferences").select("*").eq("employee_id",t.id).maybeSingle();i(n||(N=>({...N,employee_id:t.id})))}}catch(r){console.error("Error loading preferences:",r)}finally{h(!1)}},j=async()=>{if(x){m(!0),c(!1);try{const r={employee_id:x,email_notifications:s.email_notifications,vesting_reminders:s.vesting_reminders,document_alerts:s.document_alerts,price_alerts:s.price_alerts,tax_reminders:s.tax_reminders,price_alert_threshold:s.price_alert_threshold,reminder_days_before:s.reminder_days_before,updated_at:new Date().toISOString()},{error:t}=await o.from("employee_notification_preferences").upsert(r,{onConflict:"employee_id"});if(t)throw t;c(!0),setTimeout(()=>c(!1),3e3)}catch(r){console.error("Error saving preferences:",r)}finally{m(!1)}}},l=r=>{i(t=>({...t,[r]:!t[r]}))},f=(r,t)=>{i(n=>({...n,[r]:t}))};return b?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Loading preferences..."})]}):e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(v,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Notification Preferences"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage how you receive updates and alerts"})]})]}),g&&e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx(_,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Saved"})]})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx(w,{className:"w-5 h-5 text-gray-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Receive general email notifications about your account and grants"})]})]}),e.jsx("button",{onClick:()=>l("email_notifications"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.email_notifications?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.email_notifications?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-start justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx(S,{className:"w-5 h-5 text-gray-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Vesting Reminders"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Get reminders before your shares vest"}),s.vesting_reminders&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Remind me (days before)"}),e.jsx("input",{type:"number",value:s.reminder_days_before,onChange:r=>f("reminder_days_before",Number(r.target.value)),className:"w-32 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"30"})]})]})]}),e.jsx("button",{onClick:()=>l("vesting_reminders"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.vesting_reminders?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.vesting_reminders?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-start justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx(k,{className:"w-5 h-5 text-gray-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Document Alerts"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Notify me when new documents are available or require signatures"})]})]}),e.jsx("button",{onClick:()=>l("document_alerts"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.document_alerts?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.document_alerts?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-start justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx(C,{className:"w-5 h-5 text-gray-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Price Alerts"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Get alerts when stock price reaches a threshold"}),s.price_alerts&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Alert threshold (SAR)"}),e.jsx("input",{type:"number",value:s.price_alert_threshold,onChange:r=>f("price_alert_threshold",Number(r.target.value)),className:"w-32 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]})]})]}),e.jsx("button",{onClick:()=>l("price_alerts"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.price_alerts?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.price_alerts?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-start justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx(u,{className:"w-5 h-5 text-gray-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Tax Reminders"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Remind me about tax obligations and deadlines"})]})]}),e.jsx("button",{onClick:()=>l("tax_reminders"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${s.tax_reminders?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.tax_reminders?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsx("div",{className:"pt-6 border-t border-gray-200",children:e.jsxs("button",{onClick:j,disabled:d,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{children:d?"Saving...":"Save Preferences"})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(u,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:"About Notifications"}),e.jsx("p",{children:"You can manage your notification preferences at any time. Critical security and legal notifications will still be sent regardless of your preferences."})]})]})})]})]})}function I(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notification Preferences"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage how you receive updates and alerts"})]}),e.jsx(P,{})]})}export{I as default};
